{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"community/","title":"Community","text":"<p>Chainsaw has a growing community and we would definitely love to see you join and contribute.</p> <p>Everyone is welcome to make suggestions, report bugs, open feature requests, contribute code or docs, participate in discussions, write blogs or anything that can benefit the project.</p> <p> Chainsaw is built and maintained under the Kyverno umbrella but decisions are Community driven Everyone's voice matters <p></p>"},{"location":"community/#slack-channel","title":"Slack channel","text":"<p>Join our slack channel #kyverno-chainsaw to meet with users, contributors and maintainers.</p>"},{"location":"community/#community-meetings","title":"Community Meetings","text":"<p>To attend our community meetings, join the Chainsaw group. You will then be sent a meeting invite and will have access to the agenda and meeting notes. Any member may suggest topics for discussion.</p> <p>This is a public, weekly for Kyverno-Chainsaw maintainers to make announcements and provide project updates, and request input and feedback. This forum allows community members to raise agenda items of any sort, including but not limited to any PRs or issues on which they are working.</p> <p>Weekly every Thursday at 2:00 PM UTC</p> <ul> <li>Chainsaw group</li> <li>Zoom Meeting</li> <li>Agenda and meeting notes</li> </ul>"},{"location":"community/#roadmap","title":"RoadMap","text":"<p>For detailed information on our planned features and upcoming updates, please view our Roadmap.</p>"},{"location":"community/#contributing","title":"Contributing","text":"<p>Please read the contributing guide for details around:</p> <ol> <li>Code of Conduct</li> <li>Code Culture</li> <li>Details on how to contribute</li> </ol>"},{"location":"community/#adopters","title":"Adopters","text":"<p>If you are using Chainsaw and want to share it publicly we always appreciate a bit of support. Pull requests to the ADOPTERS LIST will put a smile on our faces </p>"},{"location":"docs/","title":"Documentation","text":"<p>Starting with Chainsaw <code>v0.0.6</code> we maintain separate docs per version:</p> <ul> <li>Every version released has its own documentation</li> <li>Current work in progress (<code>main</code> branch) is also available</li> </ul>"},{"location":"gh-action/","title":"GitHub action","text":"<p>A GitHub action is available to easily install Chainsaw in your workflows.</p> <p>The GitHub action is available at kyverno/action-install-chainsaw or in the marketplace.</p>"},{"location":"gh-action/#usage","title":"Usage","text":"<p>This action currently supports GitHub-provided Linux, macOS and Windows runners (self-hosted runners may not work).</p> <p>Add the following entry to your Github workflow YAML file:</p> <pre><code>uses: kyverno/action-install-chainsaw@v0.1.0\nwith:\n  release: v0.1.0 # optional\n</code></pre> <p>Example using a pinned version:</p> <pre><code>jobs:\n  example:\n    runs-on: ubuntu-latest\n\n    permissions: {}\n\n    name: Install Chainsaw\n    steps:\n      - name: Install Chainsaw\n        uses: kyverno/action-install-chainsaw@v0.1.0\n        with:\n          release: v0.0.9\n      - name: Check install\n        run: chainsaw version\n</code></pre> <p>Example using the default version:</p> <pre><code>jobs:\n  example:\n    runs-on: ubuntu-latest\n\n    permissions: {}\n\n    name: Install Chainsaw\n    steps:\n      - name: Install Chainsaw\n        uses: kyverno/action-install-chainsaw@v0.1.0\n      - name: Check install\n        run: chainsaw version\n</code></pre> <p>Example using cosign verification:</p> <pre><code>jobs:\n  example:\n    runs-on: ubuntu-latest\n\n    permissions: {}\n\n    name: Install Chainsaw\n    steps:\n      - name: Install Cosign\n        uses: sigstore/cosign-installer@v3.1.1\n      - name: Install Chainsaw\n        uses: kyverno/action-install-chainsaw@v0.1.0\n        with:\n          verify: true\n      - name: Check install\n        run: chainsaw version\n</code></pre> <p>If you want to install Chainsaw from its main version by using <code>go install</code> under the hood, you can set <code>release</code> as <code>main</code>. Once you did that, Chainsaw will be installed via <code>go install</code> which means that please ensure that go is installed.</p> <p>Example of installing Chainsaw via <code>go install</code>:</p> <pre><code>jobs:\n  example:\n    runs-on: ubuntu-latest\n\n    permissions: {}\n\n    name: Install Chainsaw via go install\n    steps:\n      - name: Install go\n        uses: actions/setup-go@v4\n        with:\n          go-version: '1.21'\n      - name: Install Chainsaw\n        uses: kyverno/action-install-chainsaw@v0.1.0\n        with:\n          release: main\n      - name: Check install\n        run: chainsaw version\n</code></pre>"},{"location":"gh-action/#optional-inputs","title":"Optional Inputs","text":"<p>The following optional inputs:</p> Input Description <code>release</code> <code>chainsaw</code> version to use instead of the default. <code>install-dir</code> directory to place the <code>chainsaw</code> binary into instead of the default (<code>$HOME/.chainsaw</code>). <code>use-sudo</code> set to <code>true</code> if <code>install-dir</code> location requires sudo privs. Defaults to false. <code>verify</code> set to <code>true</code> to enable cosign verification of the downloaded archive."},{"location":"install/","title":"Install","text":"<p>You can install the pre-compiled binary (in several ways), compile from sources, or run with Docker.</p> <p>We also provide a GitHub action to easily install Chainsaw in your workflows.</p>"},{"location":"install/#install-the-pre-compiled-binary","title":"Install the pre-compiled binary","text":""},{"location":"install/#homebrew-tap","title":"Homebrew tap","text":"<p>add tap:</p> <pre><code>brew tap kyverno/chainsaw https://github.com/kyverno/chainsaw\n</code></pre> <p>install chainsaw:</p> <pre><code>brew install kyverno/chainsaw/chainsaw\n</code></pre> <p>Don't forget to specify the tap name</p> <p>Homebrew core already has a tool named <code>chainsaw</code>.</p> <p>Be sure that you specify the tap name when installing to install the right tool.</p>"},{"location":"install/#manually","title":"Manually","text":"<p>Download the pre-compiled binaries for your system from the releases page and copy them to the desired location.</p>"},{"location":"install/#install-using-go-install","title":"Install using <code>go install</code>","text":"<p>You can install with <code>go install</code> with:</p> <pre><code>go install github.com/kyverno/chainsaw@latest\n</code></pre>"},{"location":"install/#running-with-docker","title":"Running with Docker","text":"<p>Chainsaw is also available as a Docker image which you can pull and run:</p> <pre><code>docker pull ghcr.io/kyverno/chainsaw:&lt;version&gt;\n</code></pre> <p>Info</p> <p>Since Chainsaw relies on files for its operation (like test definitions), you will need to bind mount the necessary directories when running it via Docker.</p> <pre><code>docker run --rm                             \\\n    -v ./testdata/e2e/:/chainsaw/           \\\n    -v ${HOME}/.kube/:/etc/kubeconfig/      \\\n    -e KUBECONFIG=/etc/kubeconfig/config    \\\n    --network=host                          \\\n    ghcr.io/kyverno/chainsaw:&lt;version&gt;      \\\n    test /chainsaw --config /chainsaw/config.yaml\n</code></pre>"},{"location":"install/#compiling-from-sources","title":"Compiling from sources","text":"<p>clone:</p> <p><pre><code>git clone https://github.com/kyverno/chainsaw.git\n</code></pre> build the binaries:</p> <pre><code>cd chainsaw\ngo mod tidy\nmake build\n</code></pre> <p>verify it works:</p> <pre><code>./chainsaw version\n</code></pre>"},{"location":"install/#github-action","title":"GitHub action","text":"<p>A GitHub action is available to install Chainsaw in your workflows. See the GitHub action dedicated documentation.</p>"},{"location":"intro/","title":"Introduction","text":"<p>Chainsaw is a tool developed to run end to end tests in Kubernetes clusters.</p> <p>It is meant to test Kubernetes operators work as expected by running a sequence of test steps for:</p> <ul> <li>Creating resources</li> <li>Asserting operators react (or not) the way they should</li> </ul>"},{"location":"intro/#why-we-made-it","title":"Why we made it ?","text":"<p>While developing Kyverno we need to run end to end tests to make sure our admission controller works as expected.</p> <p>A typical Kyverno end to end test</p> <p>Kyverno can validate, mutate and generate resources based on policies installed in a cluster and a typical test is:</p> <ol> <li>Create a policy</li> <li>Create a resource</li> <li>Check that Kyverno acted as expected</li> <li>Cleanup and move to the next test</li> </ol>"},{"location":"intro/#from-kuttl-to-chainsaw","title":"From KUTTL to Chainsaw","text":"<p>We started with another tool called KUTTL.</p> <p>While KUTTL was a great tool to start with, we quickly identified some limitations and forked it to add the features we needed.</p> <p>In the end we needed more flexibility than what KUTTL could offer and we started designing a new assertion model and at this point it was simpler to start a new tool from scratch than continuing making changes in our KUTTL fork.</p> <p>The changes we were making was simply too large to have a chance to be incorporated upstream.</p> <p>Chainsaw was born </p>"},{"location":"intro/#kuttl-compatibility","title":"KUTTL compatibility","text":"<p>Fortunately, Chainsaw assertion model is compatible with KUTTL and therefore migration to Chainsaw is relatively easy.</p> <p>We provide <code>chainsaw migrate kuttl config</code> and <code>chainsaw migrate kuttl tests</code> commands to assist with the migration, see Migration from KUTTL for details.</p>"},{"location":"intro/#use-cases","title":"Use cases","text":"<p>Chainsaw is built with CI tools in mind - you only really need to download and execute it in your build script.</p> <p>Installing it in your machine is entirely up to you, but still possible.</p>"},{"location":"json-schemas/","title":"JSON schemas","text":"<p>JSON schemas for Chainsaw resources are available to enable validation and autocompletion in your IDE:</p> <ul> <li>Configuration</li> <li>Test</li> </ul>"},{"location":"json-schemas/#vs-code","title":"VS code","text":"<p>In VS code, simply add a comment on top of your YAML resources.</p>"},{"location":"json-schemas/#test","title":"Test","text":"<pre><code># yaml-language-server: $schema=https://raw.githubusercontent.com/kyverno/chainsaw/main/.schemas/json/test-chainsaw-v1alpha1.json\napiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: basic\nspec:\n  steps:\n  - try:\n    - apply:\n        file: configmap.yaml\n    - assert:\n        file: configmap-assert.yaml\n</code></pre>"},{"location":"json-schemas/#configuration","title":"Configuration","text":"<pre><code># yaml-language-server: $schema=https://raw.githubusercontent.com/kyverno/chainsaw/main/.schemas/json/configuration-chainsaw-v1alpha1.json\napiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Configuration\nmetadata:\n  name: congiguration\nspec:\n  fullName: true\n  failFast: true\n  forceTerminationGracePeriod: 5s\n</code></pre>"},{"location":"json-schemas/#applying-crds","title":"Applying CRDs","text":"<p>An alternative is to apply the Chainsaw CRDs in a kubernetes cluster and let the Kubernetes extension do the rest.</p> <p>CRD definitions are provided in our GitHub repository.</p> <p>The command below will apply the Chainsaw CRDs to the configured cluster:</p> <pre><code>kubectl apply -f https://raw.githubusercontent.com/kyverno/chainsaw/main/config/crds/chainsaw.kyverno.io_configurations.yaml\nkubectl apply -f https://raw.githubusercontent.com/kyverno/chainsaw/main/config/crds/chainsaw.kyverno.io_tests.yaml\n</code></pre>"},{"location":"json-schemas/#exporting-schemas","title":"Exporting schemas","text":"<p>Chainsaw can export JSON schemas locally.</p> <pre><code>chainsaw export schemas &lt;local path&gt;\n</code></pre> <p>See Chainsaw export schemas reference for more details.</p>"},{"location":"quick-start/","title":"Quick start","text":"<p>To use Chainsaw you will need a Kubernetes cluster, Chainsaw won't create one for you.</p> <p>In this Quick start we will use kind but feel free to use the tool of your choice.</p> <p>Not a cluster management tool</p> <p>We consider this is not the responsibility of Chainsaw to manage clusters.</p> <p>There are plenty of solutions to create and manage local clusters that will do that better than Chainsaw.</p>"},{"location":"quick-start/#create-a-kind-cluster","title":"Create a kind cluster","text":"<p>Please refer to the kind install docs to install it locally.</p> <p>Once kind creating a local cluster is as simple as running:</p> <pre><code># define kind image\nexport KIND_IMAGE=\"kindest/node:v1.28.0\"\n\n# create cluster\nkind create cluster --image $KIND_IMAGE\n</code></pre>"},{"location":"quick-start/#writing-tests","title":"Writing tests","text":"<p>A Chainsaw test is made of YAML files in a folder.</p> <p>YAML files can contain raw manifests with a special file naming convention to identify the step operations. This is useful to create tests quickly but doesn't allow great flexibility.</p> <p>Another option is to have a <code>chainsaw-test.yaml</code> file containing a <code>Test</code> resource. While more verbose, this offers full flexibility over the test and test steps configuration.</p>"},{"location":"quick-start/#quick-start_1","title":"Quick start","text":"<p>For this quick start, we will create a <code>Test</code> with one step and two operations:</p> <ol> <li>Create a <code>ConfigMap</code> from a manifest</li> <li>Verify the <code>ConfigMap</code> was created and contains the expected data</li> </ol>"},{"location":"quick-start/#create-the-test-folder","title":"Create the test folder","text":"<pre><code># create test folder\nmkdir chainsaw-quick-start\n\n# enter test folder\ncd chainsaw-quick-start\n</code></pre>"},{"location":"quick-start/#create-a-configmap","title":"Create a <code>ConfigMap</code>","text":"<pre><code># create a ConfigMap\ncat &gt; configmap.yaml &lt;&lt; EOF\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: chainsaw-quick-start\ndata:\n  foo: bar\nEOF\n</code></pre>"},{"location":"quick-start/#create-the-test","title":"Create the test","text":"<p>By default, Chainsaw will look for a file named <code>chainsaw-test.yaml</code> in every folder.</p> <pre><code># create test file\ncat &gt; chainsaw-test.yaml &lt;&lt; EOF\napiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: quick-start\nspec:\n  steps:\n  - try:\n    # first operation: create the config map\n    - apply:\n        # file is relative to the test folder\n        file: configmap.yaml\n    # second operation: verify the config map exists and contains the expected data\n    - assert:\n        # file is relative to the test folder\n        file: configmap.yaml\nEOF\n</code></pre>"},{"location":"quick-start/#run-chainsaw","title":"Run Chainsaw","text":"<p>We finished writing our first test, now we can run Chainsaw to verify the test runs as expected:</p> <pre><code>chainsaw test\n\nVersion: (devel)\nLoading default configuration...\n- Using test file: chainsaw-test.yaml\n- TestDirs [.]\n- SkipDelete false\n- FailFast false\n- ReportFormat ''\n- ReportName 'chainsaw-report'\n- Namespace ''\n- FullName false\n- IncludeTestRegex ''\n- ExcludeTestRegex ''\n- ApplyTimeout 5s\n- AssertTimeout 30s\n- CleanupTimeout 30s\n- DeleteTimeout 15s\n- ErrorTimeout 30s\n- ExecTimeout 5s\nLoading tests...\n- quick-start (.)\nRunning tests...\n=== RUN   chainsaw\n=== PAUSE chainsaw\n=== CONT  chainsaw\n=== RUN   chainsaw/quick-start\n=== PAUSE chainsaw/quick-start\n=== CONT  chainsaw/quick-start\n    | 10:44:26 | quick-start | @setup   | CREATE    | OK    | v1/Namespace @ chainsaw-immense-jay\n    | 10:44:26 | quick-start | step-1   | TRY       | RUN   |\n    | 10:44:26 | quick-start | step-1   | APPLY     | RUN   | v1/ConfigMap @ chainsaw-immense-jay/chainsaw-quick-start\n    | 10:44:26 | quick-start | step-1   | CREATE    | OK    | v1/ConfigMap @ chainsaw-immense-jay/chainsaw-quick-start\n    | 10:44:26 | quick-start | step-1   | APPLY     | DONE  | v1/ConfigMap @ chainsaw-immense-jay/chainsaw-quick-start\n    | 10:44:26 | quick-start | step-1   | ASSERT    | RUN   | v1/ConfigMap @ chainsaw-immense-jay/chainsaw-quick-start\n    | 10:44:26 | quick-start | step-1   | ASSERT    | DONE  | v1/ConfigMap @ chainsaw-immense-jay/chainsaw-quick-start\n    | 10:44:26 | quick-start | step-1   | TRY       | DONE  |\n    | 10:44:26 | quick-start | @cleanup | DELETE    | RUN   | v1/ConfigMap @ chainsaw-immense-jay/chainsaw-quick-start\n    | 10:44:26 | quick-start | @cleanup | DELETE    | OK    | v1/ConfigMap @ chainsaw-immense-jay/chainsaw-quick-start\n    | 10:44:26 | quick-start | @cleanup | DELETE    | DONE  | v1/ConfigMap @ chainsaw-immense-jay/chainsaw-quick-start\n    | 10:44:26 | quick-start | @cleanup | DELETE    | RUN   | v1/Namespace @ chainsaw-immense-jay\n    | 10:44:26 | quick-start | @cleanup | DELETE    | OK    | v1/Namespace @ chainsaw-immense-jay\n    | 10:44:31 | quick-start | @cleanup | DELETE    | DONE  | v1/Namespace @ chainsaw-immense-jay\n--- PASS: chainsaw (0.00s)\n    --- PASS: chainsaw/quick-start (5.25s)\nPASS\nTests Summary...\n- Passed  tests 1\n- Failed  tests 0\n- Skipped tests 0\nDone.\n</code></pre>"},{"location":"quick-start/#chainsaw-charaterstics","title":"Chainsaw Charaterstics","text":"<p>Resource diff in assertion failures: Chainsaw offers detailed resource diffs upon assertion failures. It provides a clear view of discrepancies between expected and actual resource.</p> <p>Resource templating support: Chainsaw simplifies dynamic resource configuration with it's templating support. Instead on relying on <code>envsubst</code> for dynamic substitution of env-variable. This eliminates the need of any preprocessing step.</p>"},{"location":"resources/","title":"Resources","text":"<p>Resources, blog posts and videos talking about Chainsaw:</p> <ul> <li>Kyverno Chainsaw - The ultimate end-to-end testing tool!</li> <li>Kyverno Chainsaw - Exploring the Power of Assertion Trees!</li> <li>Nirmata Office Hours for Kyverno- Episode 9- Demonstrate Kyverno Chainsaw</li> <li>Kubebuilder Community Meeting - February 1, 2024</li> <li>Kyverno Chainsaw 0.1.4 - Awesome new features!</li> </ul>"},{"location":"writing-tests/","title":"What is Chainsaw","text":""},{"location":"writing-tests/#overview","title":"Overview","text":"<p>Chainsaw provides a declarative approach to testing production-grade Kubernetes operators and controllers.</p> <p>It provides a way to inject an operator (subject under test) during the setup and allows tests to be standard YAML files.</p> <p>In Chainsaw everything is YAML. We use YAML to manipulate resources, define cluster state assertions, describe commands to run, etc... Everything is declarative.</p>"},{"location":"writing-tests/#motivation","title":"Motivation","text":"<p>Testing Kubernetes operators is not easy.</p> <p>At Kyverno we are building complex controllers and admission controllers that need to be deeply end to end tested.</p> <p>Advantages of a declarative approach</p> <p>It made sense to be able to declaratively create end to end tests for a couple of reasons:</p> <ul> <li>Easily translate a reported issue to an end to end test</li> <li>Add new end to end tests without writing a single line of code</li> </ul>"},{"location":"writing-tests/#when-would-you-use-chainsaw","title":"When would you use Chainsaw","text":"<p>The testing eco-system is vast and includes at a minimum low level unit tests, integration tests and end-to-end testing.</p> <p>Chainsaw is built to support some kubernetes integration test scenarios and is most valuable as an end to end testing tool.</p> <p>Chainsaw is great for</p> <ul> <li>Provide tests against your Custom Resource Definitions (CRDs)</li> <li>Inject a controller and assert states in a running cluster</li> <li>Run same tests against multiple implementations and multiple versions of Kubernetes clusters</li> </ul>"},{"location":"apis/chainsaw.v1alpha1/","title":"chainsaw (v1alpha1)","text":"<p>Package v1alpha1 contains API Schema definitions for the v1alpha1 API group.</p>"},{"location":"apis/chainsaw.v1alpha1/#resource-types","title":"Resource Types","text":"<ul> <li>Configuration</li> <li>Test</li> <li>TestStep</li> </ul>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Configuration","title":"<code>Configuration</code>","text":"<p>Configuration is the resource that contains the configuration used to run tests.</p> Field Type Required Inline Description <code>apiVersion</code> <code>string</code> <code>chainsaw.kyverno.io/v1alpha1</code> <code>kind</code> <code>string</code> <code>Configuration</code> <code>metadata</code> <code>meta/v1.ObjectMeta</code> <p>Standard object's metadata.</p> <code>spec</code> <code>ConfigurationSpec</code> <p>Configuration spec.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Test","title":"<code>Test</code>","text":"<p>Test is the resource that contains a test definition.</p> Field Type Required Inline Description <code>apiVersion</code> <code>string</code> <code>chainsaw.kyverno.io/v1alpha1</code> <code>kind</code> <code>string</code> <code>Test</code> <code>metadata</code> <code>meta/v1.ObjectMeta</code> <p>Standard object's metadata.</p> <code>spec</code> <code>TestSpec</code> <p>Test spec.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-TestStep","title":"<code>TestStep</code>","text":"<p>TestStep is the resource that contains the testStep used to run tests.</p> Field Type Required Inline Description <code>apiVersion</code> <code>string</code> <code>chainsaw.kyverno.io/v1alpha1</code> <code>kind</code> <code>string</code> <code>TestStep</code> <code>metadata</code> <code>meta/v1.ObjectMeta</code> <p>Standard object's metadata.</p> <code>spec</code> <code>TestStepSpec</code> <p>TestStep spec.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Apply","title":"<code>Apply</code>","text":"<p>Appears in:</p> <ul> <li>Operation</li> </ul> <p>Apply represents a set of configurations or resources that should be applied during testing.</p> Field Type Required Inline Description <code>timeout</code> <code>meta/v1.Duration</code> <p>Timeout for the operation. Overrides the global timeout set in the Configuration.</p> <code>bindings</code> <code>[]Binding</code> <p>Bindings defines additional binding key/values.</p> <code>cluster</code> <code>string</code> <p>Cluster defines the target cluster (default cluster will be used if not specified and/or overridden).</p> <code>FileRefOrResource</code> <code>FileRefOrResource</code> <p>FileRefOrResource provides a reference to the resources to be applied.</p> <code>template</code> <code>bool</code> <p>Template determines whether resources should be considered for templating.</p> <code>dryRun</code> <code>bool</code> <p>DryRun determines whether the file should be applied in dry run mode.</p> <code>expect</code> <code>[]Expectation</code> <p>Expect defines a list of matched checks to validate the operation outcome.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Assert","title":"<code>Assert</code>","text":"<p>Appears in:</p> <ul> <li>Operation</li> </ul> <p>Assert represents a test condition that is expected to hold true during the testing process.</p> Field Type Required Inline Description <code>timeout</code> <code>meta/v1.Duration</code> <p>Timeout for the operation. Overrides the global timeout set in the Configuration.</p> <code>bindings</code> <code>[]Binding</code> <p>Bindings defines additional binding key/values.</p> <code>cluster</code> <code>string</code> <p>Cluster defines the target cluster (default cluster will be used if not specified and/or overridden).</p> <code>FileRefOrCheck</code> <code>FileRefOrCheck</code> <p>FileRefOrAssert provides a reference to the assertion.</p> <code>template</code> <code>bool</code> <p>Template determines whether resources should be considered for templating.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Binding","title":"<code>Binding</code>","text":"<p>Appears in:</p> <ul> <li>Apply</li> <li>Assert</li> <li>Command</li> <li>Create</li> <li>Delete</li> <li>Error</li> <li>Patch</li> <li>Script</li> <li>TestSpec</li> <li>TestStepSpec</li> </ul> <p>Binding represents a key/value set as a binding in an executing test.</p> Field Type Required Inline Description <code>name</code> <code>string</code> <p>Name the name of the binding.</p> <code>value</code> <code>policy/v1alpha1.Any</code> <p>Value value of the binding.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Catch","title":"<code>Catch</code>","text":"<p>Appears in:</p> <ul> <li>TestStepSpec</li> </ul> <p>Catch defines actions to be executed on failure.</p> Field Type Required Inline Description <code>description</code> <code>string</code> <p>Description contains a description of the operation.</p> <code>podLogs</code> <code>PodLogs</code> <p>PodLogs determines the pod logs collector to execute.</p> <code>events</code> <code>Events</code> <p>Events determines the events collector to execute.</p> <code>describe</code> <code>Describe</code> <p>Describe determines the resource describe collector to execute.</p> <code>wait</code> <code>Wait</code> <p>Wait determines the resource wait collector to execute.</p> <code>get</code> <code>Get</code> <p>Get determines the resource get collector to execute.</p> <code>delete</code> <code>Delete</code> <p>Delete represents a deletion operation.</p> <code>command</code> <code>Command</code> <p>Command defines a command to run.</p> <code>script</code> <code>Script</code> <p>Script defines a script to run.</p> <code>sleep</code> <code>Sleep</code> <p>Sleep defines zzzz.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Cluster","title":"<code>Cluster</code>","text":"<p>Appears in:</p> <ul> <li>ConfigurationSpec</li> </ul> Field Type Required Inline Description <code>kubeconfig</code> <code>string</code> <p>Kubeconfig is the path to the referenced file.</p> <code>context</code> <code>string</code> <p>Context is the name of the context to use.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Command","title":"<code>Command</code>","text":"<p>Appears in:</p> <ul> <li>Catch</li> <li>Finally</li> <li>Operation</li> </ul> <p>Command describes a command to run as a part of a test step.</p> Field Type Required Inline Description <code>timeout</code> <code>meta/v1.Duration</code> <p>Timeout for the operation. Overrides the global timeout set in the Configuration.</p> <code>bindings</code> <code>[]Binding</code> <p>Bindings defines additional binding key/values.</p> <code>env</code> <code>[]Binding</code> <p>Env defines additional environment variables.</p> <code>cluster</code> <code>string</code> <p>Cluster defines the target cluster (default cluster will be used if not specified and/or overridden).</p> <code>entrypoint</code> <code>string</code> <p>Entrypoint is the command entry point to run.</p> <code>args</code> <code>[]string</code> <p>Args is the command arguments.</p> <code>skipLogOutput</code> <code>bool</code> <p>SkipLogOutput removes the output from the command. Useful for sensitive logs or to reduce noise.</p> <code>check</code> <code>policy/v1alpha1.Any</code> <p>Check is an assertion tree to validate the operation outcome.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Condition","title":"<code>Condition</code>","text":"<p>Appears in:</p> <ul> <li>For</li> </ul> <p>Condition represents parameters for waiting on a specific condition of a resource.</p> Field Type Required Inline Description <code>name</code> <code>string</code> <p>Name defines the specific condition to wait for, e.g., \"Available\", \"Ready\".</p> <code>value</code> <code>string</code> <p>Value defines the specific condition status to wait for, e.g., \"True\", \"False\".</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-ConfigurationSpec","title":"<code>ConfigurationSpec</code>","text":"<p>Appears in:</p> <ul> <li>Configuration</li> </ul> <p>ConfigurationSpec contains the configuration used to run tests.</p> Field Type Required Inline Description <code>timeouts</code> <code>Timeouts</code> <p>Global timeouts configuration. Applies to all tests/test steps if not overridden.</p> <code>skipDelete</code> <code>bool</code> <p>If set, do not delete the resources after running the tests (implies SkipClusterDelete).</p> <code>template</code> <code>bool</code> <p>Template determines whether resources should be considered for templating.</p> <code>failFast</code> <code>bool</code> <p>FailFast determines whether the test should stop upon encountering the first failure.</p> <code>parallel</code> <code>int</code> <p>The maximum number of tests to run at once.</p> <code>reportFormat</code> <code>ReportFormatType</code> <p>ReportFormat determines test report format (JSON <code>reportPath</code> <code>string</code> <p>ReportPath defines the path.</p> <code>reportName</code> <code>string</code> <p>ReportName defines the name of report to create. It defaults to \"chainsaw-report\".</p> <code>namespace</code> <code>string</code> <p>Namespace defines the namespace to use for tests. If not specified, every test will execute in a random ephemeral namespace unless the namespace is overridden in a the test spec.</p> <code>namespaceTemplate</code> <code>policy/v1alpha1.Any</code> <p>NamespaceTemplate defines a template to create the test namespace.</p> <code>fullName</code> <code>bool</code> <p>FullName makes use of the full test case folder path instead of the folder name.</p> <code>excludeTestRegex</code> <code>string</code> <p>ExcludeTestRegex is used to exclude tests based on a regular expression.</p> <code>includeTestRegex</code> <code>string</code> <p>IncludeTestRegex is used to include tests based on a regular expression.</p> <code>repeatCount</code> <code>int</code> <p>RepeatCount indicates how many times the tests should be executed.</p> <code>testFile</code> <code>string</code> <p>TestFile is the name of the file containing the test to run. If no extension is provided, chainsaw will try with .yaml first and .yml if needed.</p> <code>forceTerminationGracePeriod</code> <code>meta/v1.Duration</code> <p>ForceTerminationGracePeriod forces the termination grace period on pods, statefulsets, daemonsets and deployments.</p> <code>delayBeforeCleanup</code> <code>meta/v1.Duration</code> <p>DelayBeforeCleanup adds a delay between the time a test ends and the time cleanup starts.</p> <code>clusters</code> <code>map[string]Cluster</code> <p>Clusters holds a registry to clusters to support multi-cluster tests.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Create","title":"<code>Create</code>","text":"<p>Appears in:</p> <ul> <li>Operation</li> </ul> <p>Create represents a set of resources that should be created. If a resource already exists in the cluster it will fail.</p> Field Type Required Inline Description <code>timeout</code> <code>meta/v1.Duration</code> <p>Timeout for the operation. Overrides the global timeout set in the Configuration.</p> <code>bindings</code> <code>[]Binding</code> <p>Bindings defines additional binding key/values.</p> <code>cluster</code> <code>string</code> <p>Cluster defines the target cluster (default cluster will be used if not specified and/or overridden).</p> <code>FileRefOrResource</code> <code>FileRefOrResource</code> <p>FileRefOrResource provides a reference to the file containing the resources to be created.</p> <code>template</code> <code>bool</code> <p>Template determines whether resources should be considered for templating.</p> <code>dryRun</code> <code>bool</code> <p>DryRun determines whether the file should be applied in dry run mode.</p> <code>expect</code> <code>[]Expectation</code> <p>Expect defines a list of matched checks to validate the operation outcome.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Delete","title":"<code>Delete</code>","text":"<p>Appears in:</p> <ul> <li>Catch</li> <li>Finally</li> <li>Operation</li> </ul> <p>Delete is a reference to an object that should be deleted</p> Field Type Required Inline Description <code>timeout</code> <code>meta/v1.Duration</code> <p>Timeout for the operation. Overrides the global timeout set in the Configuration.</p> <code>bindings</code> <code>[]Binding</code> <p>Bindings defines additional binding key/values.</p> <code>cluster</code> <code>string</code> <p>Cluster defines the target cluster (default cluster will be used if not specified and/or overridden).</p> <code>template</code> <code>bool</code> <p>Template determines whether resources should be considered for templating.</p> <code>ref</code> <code>ObjectReference</code> <p>ObjectReference determines objects to be deleted.</p> <code>expect</code> <code>[]Expectation</code> <p>Expect defines a list of matched checks to validate the operation outcome.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Deletion","title":"<code>Deletion</code>","text":"<p>Appears in:</p> <ul> <li>For</li> </ul> <p>Deletion represents parameters for waiting on a resource's deletion.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Describe","title":"<code>Describe</code>","text":"<p>Appears in:</p> <ul> <li>Catch</li> <li>Finally</li> </ul> <p>Describe defines how to describe resources.</p> Field Type Required Inline Description <code>timeout</code> <code>meta/v1.Duration</code> <p>Timeout for the operation. Overrides the global timeout set in the Configuration.</p> <code>cluster</code> <code>string</code> <p>Cluster defines the target cluster (default cluster will be used if not specified and/or overridden).</p> <code>resource</code> <code>string</code> <p>Resource type.</p> <code>ObjectLabelsSelector</code> <code>ObjectLabelsSelector</code> <p>ObjectLabelsSelector determines the selection process of referenced objects.</p> <code>showEvents</code> <code>bool</code> <p>Show Events indicates whether to include related events.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Error","title":"<code>Error</code>","text":"<p>Appears in:</p> <ul> <li>Operation</li> </ul> <p>Error represents an anticipated error condition that may arise during testing. Instead of treating such an error as a test failure, it acknowledges it as expected.</p> Field Type Required Inline Description <code>timeout</code> <code>meta/v1.Duration</code> <p>Timeout for the operation. Overrides the global timeout set in the Configuration.</p> <code>bindings</code> <code>[]Binding</code> <p>Bindings defines additional binding key/values.</p> <code>cluster</code> <code>string</code> <p>Cluster defines the target cluster (default cluster will be used if not specified and/or overridden).</p> <code>FileRefOrCheck</code> <code>FileRefOrCheck</code> <p>FileRefOrAssert provides a reference to the expected error.</p> <code>template</code> <code>bool</code> <p>Template determines whether resources should be considered for templating.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Events","title":"<code>Events</code>","text":"<p>Appears in:</p> <ul> <li>Catch</li> <li>Finally</li> </ul> <p>Events defines how to collect events.</p> Field Type Required Inline Description <code>timeout</code> <code>meta/v1.Duration</code> <p>Timeout for the operation. Overrides the global timeout set in the Configuration.</p> <code>cluster</code> <code>string</code> <p>Cluster defines the target cluster (default cluster will be used if not specified and/or overridden).</p> <code>ObjectLabelsSelector</code> <code>ObjectLabelsSelector</code> <p>ObjectLabelsSelector determines the selection process of referenced objects.</p> <code>format</code> <code>Format</code> <p>Format determines the output format (json or yaml).</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Expectation","title":"<code>Expectation</code>","text":"<p>Appears in:</p> <ul> <li>Apply</li> <li>Create</li> <li>Delete</li> <li>Patch</li> </ul> <p>Expectation represents a check to be applied on the result of an operation with a match filter to determine if the verification should be considered.</p> Field Type Required Inline Description <code>match</code> <code>policy/v1alpha1.Any</code> <p>Match defines the matching statement.</p> <code>check</code> <code>policy/v1alpha1.Any</code> <p>Check defines the verification statement.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-FileRef","title":"<code>FileRef</code>","text":"<p>Appears in:</p> <ul> <li>FileRefOrCheck</li> <li>FileRefOrResource</li> </ul> <p>FileRef represents a file reference.</p> Field Type Required Inline Description <code>file</code> <code>string</code> <p>File is the path to the referenced file. This can be a direct path to a file or an expression that matches multiple files, such as \"manifest/*.yaml\" for all YAML files within the \"manifest\" directory.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-FileRefOrCheck","title":"<code>FileRefOrCheck</code>","text":"<p>Appears in:</p> <ul> <li>Assert</li> <li>Error</li> </ul> <p>FileRefOrCheck represents a file reference or resource.</p> Field Type Required Inline Description <code>FileRef</code> <code>FileRef</code> <p>FileRef provides a reference to the file containing the resources to be applied.</p> <code>resource</code> <code>policy/v1alpha1.Any</code> <p>Check provides a check used in assertions.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-FileRefOrResource","title":"<code>FileRefOrResource</code>","text":"<p>Appears in:</p> <ul> <li>Apply</li> <li>Create</li> <li>Patch</li> </ul> <p>FileRefOrResource represents a file reference or resource.</p> Field Type Required Inline Description <code>FileRef</code> <code>FileRef</code> <p>FileRef provides a reference to the file containing the resources to be applied.</p> <code>resource</code> <code>meta/v1/unstructured.Unstructured</code> <p>Resource provides a resource to be applied.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Finally","title":"<code>Finally</code>","text":"<p>Appears in:</p> <ul> <li>TestStepSpec</li> </ul> <p>Finally defines actions to be executed at the end of a test.</p> Field Type Required Inline Description <code>description</code> <code>string</code> <p>Description contains a description of the operation.</p> <code>podLogs</code> <code>PodLogs</code> <p>PodLogs determines the pod logs collector to execute.</p> <code>events</code> <code>Events</code> <p>Events determines the events collector to execute.</p> <code>describe</code> <code>Describe</code> <p>Describe determines the resource describe collector to execute.</p> <code>wait</code> <code>Wait</code> <p>Wait determines the resource wait collector to execute.</p> <code>get</code> <code>Get</code> <p>Get determines the resource get collector to execute.</p> <code>delete</code> <code>Delete</code> <p>Delete represents a deletion operation.</p> <code>command</code> <code>Command</code> <p>Command defines a command to run.</p> <code>script</code> <code>Script</code> <p>Script defines a script to run.</p> <code>sleep</code> <code>Sleep</code> <p>Sleep defines zzzz.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-For","title":"<code>For</code>","text":"<p>Appears in:</p> <ul> <li>Wait</li> </ul> <p>For specifies the condition to wait for.</p> Field Type Required Inline Description <code>deletion</code> <code>Deletion</code> <p>Deletion specifies parameters for waiting on a resource's deletion.</p> <code>condition</code> <code>Condition</code> <p>Condition specifies the condition to wait for.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Format","title":"<code>Format</code>","text":"<p>(Alias of <code>string</code>)</p> <p>Appears in:</p> <ul> <li>Events</li> <li>Get</li> <li>Wait</li> </ul> <p>Format determines the output format (json or yaml).</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Get","title":"<code>Get</code>","text":"<p>Appears in:</p> <ul> <li>Catch</li> <li>Finally</li> </ul> <p>Get defines how to get resources.</p> Field Type Required Inline Description <code>timeout</code> <code>meta/v1.Duration</code> <p>Timeout for the operation. Overrides the global timeout set in the Configuration.</p> <code>cluster</code> <code>string</code> <p>Cluster defines the target cluster (default cluster will be used if not specified and/or overridden).</p> <code>resource</code> <code>string</code> <p>Resource type.</p> <code>ObjectLabelsSelector</code> <code>ObjectLabelsSelector</code> <p>ObjectLabelsSelector determines the selection process of referenced objects.</p> <code>format</code> <code>Format</code> <p>Format determines the output format (json or yaml).</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-ObjectLabelsSelector","title":"<code>ObjectLabelsSelector</code>","text":"<p>Appears in:</p> <ul> <li>Describe</li> <li>Events</li> <li>Get</li> <li>PodLogs</li> <li>Wait</li> </ul> <p>ObjectLabelsSelector represents a strategy to select objects. For a single object name and namespace are used to identify the object. For multiple objects use selector.</p> Field Type Required Inline Description <code>namespace</code> <code>string</code> <p>Namespace of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/</p> <code>name</code> <code>string</code> <p>Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names</p> <code>selector</code> <code>string</code> <p>Selector defines labels selector.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-ObjectReference","title":"<code>ObjectReference</code>","text":"<p>Appears in:</p> <ul> <li>Delete</li> </ul> <p>ObjectReference represents one or more objects with a specific apiVersion and kind. For a single object name and namespace are used to identify the object. For multiple objects use labels.</p> Field Type Required Inline Description <code>ObjectSelector</code> <code>ObjectSelector</code> <p>ObjectSelector determines the selection process of referenced objects.</p> <code>apiVersion</code> <code>string</code> <p>API version of the referent.</p> <code>kind</code> <code>string</code> <p>Kind of the referent. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-ObjectSelector","title":"<code>ObjectSelector</code>","text":"<p>Appears in:</p> <ul> <li>ObjectReference</li> </ul> <p>ObjectSelector represents a strategy to select objects. For a single object name and namespace are used to identify the object. For multiple objects use labels.</p> Field Type Required Inline Description <code>namespace</code> <code>string</code> <p>Namespace of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/</p> <code>name</code> <code>string</code> <p>Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names</p> <code>labels</code> <code>map[string]string</code> <p>Label selector to match objects to delete</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Operation","title":"<code>Operation</code>","text":"<p>Appears in:</p> <ul> <li>TestStepSpec</li> </ul> <p>Operation defines a single operation, only one action is permitted for a given operation.</p> Field Type Required Inline Description <code>description</code> <code>string</code> <p>Description contains a description of the operation.</p> <code>continueOnError</code> <code>bool</code> <p>ContinueOnError determines whether a test should continue or not in case the operation was not successful. Even if the test continues executing, it will still be reported as failed.</p> <code>apply</code> <code>Apply</code> <p>Apply represents resources that should be applied for this test step. This can include things like configuration settings or any other resources that need to be available during the test.</p> <code>assert</code> <code>Assert</code> <p>Assert represents an assertion to be made. It checks whether the conditions specified in the assertion hold true.</p> <code>command</code> <code>Command</code> <p>Command defines a command to run.</p> <code>create</code> <code>Create</code> <p>Create represents a creation operation.</p> <code>delete</code> <code>Delete</code> <p>Delete represents a deletion operation.</p> <code>error</code> <code>Error</code> <p>Error represents the expected errors for this test step. If any of these errors occur, the test will consider them as expected; otherwise, they will be treated as test failures.</p> <code>patch</code> <code>Patch</code> <p>Patch represents a patch operation.</p> <code>script</code> <code>Script</code> <p>Script defines a script to run.</p> <code>sleep</code> <code>Sleep</code> <p>Sleep defines zzzz.</p> <code>wait</code> <code>Wait</code> <p>Wait determines the resource wait collector to execute.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Patch","title":"<code>Patch</code>","text":"<p>Appears in:</p> <ul> <li>Operation</li> </ul> <p>Patch represents a set of resources that should be patched. If a resource doesn't exist yet in the cluster it will fail.</p> Field Type Required Inline Description <code>timeout</code> <code>meta/v1.Duration</code> <p>Timeout for the operation. Overrides the global timeout set in the Configuration.</p> <code>bindings</code> <code>[]Binding</code> <p>Bindings defines additional binding key/values.</p> <code>cluster</code> <code>string</code> <p>Cluster defines the target cluster (default cluster will be used if not specified and/or overridden).</p> <code>FileRefOrResource</code> <code>FileRefOrResource</code> <p>FileRefOrResource provides a reference to the file containing the resources to be patched.</p> <code>template</code> <code>bool</code> <p>Template determines whether resources should be considered for templating.</p> <code>dryRun</code> <code>bool</code> <p>DryRun determines whether the file should be applied in dry run mode.</p> <code>expect</code> <code>[]Expectation</code> <p>Expect defines a list of matched checks to validate the operation outcome.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-PodLogs","title":"<code>PodLogs</code>","text":"<p>Appears in:</p> <ul> <li>Catch</li> <li>Finally</li> </ul> <p>PodLogs defines how to collect pod logs.</p> Field Type Required Inline Description <code>timeout</code> <code>meta/v1.Duration</code> <p>Timeout for the operation. Overrides the global timeout set in the Configuration.</p> <code>cluster</code> <code>string</code> <p>Cluster defines the target cluster (default cluster will be used if not specified and/or overridden).</p> <code>ObjectLabelsSelector</code> <code>ObjectLabelsSelector</code> <p>ObjectLabelsSelector determines the selection process of referenced objects.</p> <code>container</code> <code>string</code> <p>Container in pod to get logs from else --all-containers is used.</p> <code>tail</code> <code>int</code> <p>Tail is the number of last lines to collect from pods. If omitted or zero, then the default is 10 if you use a selector, or -1 (all) if you use a pod name. This matches default behavior of <code>kubectl logs</code>.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-ReportFormatType","title":"<code>ReportFormatType</code>","text":"<p>(Alias of <code>string</code>)</p> <p>Appears in:</p> <ul> <li>ConfigurationSpec</li> </ul>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Script","title":"<code>Script</code>","text":"<p>Appears in:</p> <ul> <li>Catch</li> <li>Finally</li> <li>Operation</li> </ul> <p>Script describes a script to run as a part of a test step.</p> Field Type Required Inline Description <code>timeout</code> <code>meta/v1.Duration</code> <p>Timeout for the operation. Overrides the global timeout set in the Configuration.</p> <code>bindings</code> <code>[]Binding</code> <p>Bindings defines additional binding key/values.</p> <code>env</code> <code>[]Binding</code> <p>Env defines additional environment variables.</p> <code>cluster</code> <code>string</code> <p>Cluster defines the target cluster (default cluster will be used if not specified and/or overridden).</p> <code>content</code> <code>string</code> <p>Content defines a shell script (run with \"sh -c ...\").</p> <code>skipLogOutput</code> <code>bool</code> <p>SkipLogOutput removes the output from the command. Useful for sensitive logs or to reduce noise.</p> <code>check</code> <code>policy/v1alpha1.Any</code> <p>Check is an assertion tree to validate the operation outcome.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Sleep","title":"<code>Sleep</code>","text":"<p>Appears in:</p> <ul> <li>Catch</li> <li>Finally</li> <li>Operation</li> </ul> <p>Sleep represents a duration while nothing happens.</p> Field Type Required Inline Description <code>duration</code> <code>meta/v1.Duration</code> <p>Duration is the delay used for sleeping.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-TestSpec","title":"<code>TestSpec</code>","text":"<p>Appears in:</p> <ul> <li>Test</li> </ul> <p>TestSpec contains the test spec.</p> Field Type Required Inline Description <code>description</code> <code>string</code> <p>Description contains a description of the test.</p> <code>timeouts</code> <code>Timeouts</code> <p>Timeouts for the test. Overrides the global timeouts set in the Configuration on a per operation basis.</p> <code>cluster</code> <code>string</code> <p>Cluster defines the target cluster (default cluster will be used if not specified and/or overridden).</p> <code>skip</code> <code>bool</code> <p>Skip determines whether the test should skipped.</p> <code>concurrent</code> <code>bool</code> <p>Concurrent determines whether the test should run concurrently with other tests.</p> <code>skipDelete</code> <code>bool</code> <p>SkipDelete determines whether the resources created by the test should be deleted after the test is executed.</p> <code>template</code> <code>bool</code> <p>Template determines whether resources should be considered for templating.</p> <code>namespace</code> <code>string</code> <p>Namespace determines whether the test should run in a random ephemeral namespace or not.</p> <code>namespaceTemplate</code> <code>policy/v1alpha1.Any</code> <p>NamespaceTemplate defines a template to create the test namespace.</p> <code>bindings</code> <code>[]Binding</code> <p>Bindings defines additional binding key/values.</p> <code>steps</code> <code>[]TestSpecStep</code> <p>Steps defining the test.</p> <code>forceTerminationGracePeriod</code> <code>meta/v1.Duration</code> <p>ForceTerminationGracePeriod forces the termination grace period on pods, statefulsets, daemonsets and deployments.</p> <code>delayBeforeCleanup</code> <code>meta/v1.Duration</code> <p>DelayBeforeCleanup adds a delay between the time a test ends and the time cleanup starts.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-TestSpecStep","title":"<code>TestSpecStep</code>","text":"<p>Appears in:</p> <ul> <li>TestSpec</li> </ul> <p>TestSpecStep contains the test step definition used in a test spec.</p> Field Type Required Inline Description <code>name</code> <code>string</code> <p>Name of the step.</p> <code>TestStepSpec</code> <code>TestStepSpec</code> <p>TestStepSpec of the step.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-TestStepSpec","title":"<code>TestStepSpec</code>","text":"<p>Appears in:</p> <ul> <li>TestStep</li> <li>TestSpecStep</li> </ul> <p>TestStepSpec defines the desired state and behavior for each test step.</p> Field Type Required Inline Description <code>description</code> <code>string</code> <p>Description contains a description of the test step.</p> <code>timeouts</code> <code>Timeouts</code> <p>Timeouts for the test step. Overrides the global timeouts set in the Configuration and the timeouts eventually set in the Test.</p> <code>cluster</code> <code>string</code> <p>Cluster defines the target cluster (default cluster will be used if not specified and/or overridden).</p> <code>skipDelete</code> <code>bool</code> <p>SkipDelete determines whether the resources created by the step should be deleted after the test step is executed.</p> <code>template</code> <code>bool</code> <p>Template determines whether resources should be considered for templating.</p> <code>bindings</code> <code>[]Binding</code> <p>Bindings defines additional binding key/values.</p> <code>try</code> <code>[]Operation</code> <p>Try defines what the step will try to execute.</p> <code>catch</code> <code>[]Catch</code> <p>Catch defines what the step will execute when an error happens.</p> <code>finally</code> <code>[]Finally</code> <p>Finally defines what the step will execute after the step is terminated.</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Timeouts","title":"<code>Timeouts</code>","text":"<p>Appears in:</p> <ul> <li>ConfigurationSpec</li> <li>TestSpec</li> <li>TestStepSpec</li> </ul> <p>Timeouts contains timeouts per operation.</p> Field Type Required Inline Description <code>apply</code> <code>meta/v1.Duration</code> <p>Apply defines the timeout for the apply operation</p> <code>assert</code> <code>meta/v1.Duration</code> <p>Assert defines the timeout for the assert operation</p> <code>cleanup</code> <code>meta/v1.Duration</code> <p>Cleanup defines the timeout for the cleanup operation</p> <code>delete</code> <code>meta/v1.Duration</code> <p>Delete defines the timeout for the delete operation</p> <code>error</code> <code>meta/v1.Duration</code> <p>Error defines the timeout for the error operation</p> <code>exec</code> <code>meta/v1.Duration</code> <p>Exec defines the timeout for exec operations</p>"},{"location":"apis/chainsaw.v1alpha1/#chainsaw-kyverno-io-v1alpha1-Wait","title":"<code>Wait</code>","text":"<p>Appears in:</p> <ul> <li>Catch</li> <li>Finally</li> <li>Operation</li> </ul> <p>Wait specifies how to perform wait operations on resources.</p> Field Type Required Inline Description <code>timeout</code> <code>meta/v1.Duration</code> <p>Timeout for the operation. Specifies how long to wait for the condition to be met before timing out.</p> <code>cluster</code> <code>string</code> <p>Cluster defines the target cluster where the wait operation will be performed (default cluster will be used if not specified).</p> <code>resource</code> <code>string</code> <p>Resource type on which the wait operation will be applied.</p> <code>ObjectLabelsSelector</code> <code>ObjectLabelsSelector</code> <p>ObjectLabelsSelector determines the selection process of referenced objects.</p> <code>for</code> <code>For</code> <p>For specifies the condition to wait for.</p> <code>format</code> <code>Format</code> <p>Format determines the output format (json or yaml).</p>"},{"location":"bindings/","title":"Bindings","text":"<p>Chainsaw has a concept of <code>bindings</code> which can be seen as an execution context.</p> <p>Bindings are used in assertion trees and resource templating, as well as when using the <code>--values</code> flag when invoking chainsaw.</p> <p>While some bindings are built-in and provided by chainsaw, it's possible to define custom bindings at the test, step, or individual operation level. Those bindings can in turn be used to create custom environment variables in <code>command</code> and <code>script</code> operations.</p>"},{"location":"bindings/#immutability","title":"Immutability","text":"<p>It's important to note that bindings are immutable, it's not possible to overwrite a binding and two bindings with the same name can exist without overwriting each other.</p> <p>When a binding value is resolved, chainsaw will walk the binding chain upwards until it finds a binding with the expected name. Effectively, the last one registered in the chain will be used.</p>"},{"location":"bindings/#usage","title":"Usage","text":"<p>The example below defines custom bindings at the test level.</p> <p>Test level bindings</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  # bindings defined at the test level are available to all steps and operations\n  bindings:\n  - name: hello\n    value: hello\n  - name: chainsaw\n    value: chainsaw\n  # `greetings` depends on `$hello` and `$chainsaw` bindings defined above\n  - name: greetings\n    value: (join(' ', [$hello, $chainsaw]))\n  steps:\n  - try:\n    - script:\n        # custom environment variables, defined using custom bindings\n        env:\n        - name: GREETINGS\n          value: ($greetings)\n        content: echo $GREETINGS\n        check:\n          ($error): ~\n          ($stdout): hello chainsaw\n</code></pre> <p>The example below is similar to the previous one but also defines custom bindings at the step level.</p> <p>Step level bindings</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  # bindings defined at the test level are available to all steps and operations\n  bindings:\n  - name: hello\n    value: hello\n  - name: chainsaw\n    value: chainsaw\n  steps:\n  - bindings:\n    # `greetings` depends on `$hello` and `$chainsaw` bindings defined at higher levels\n    - name: greetings\n      value: (join(' ', [$hello, $chainsaw]))\n    try:\n    - script:\n        # custom environment variables, defined using custom bindings\n        env:\n        - name: GREETINGS\n          value: ($greetings)\n        content: echo $GREETINGS\n        check:\n          ($error): ~\n          ($stdout): hello chainsaw\n</code></pre> <p>Finally, custom bindings can also be defined at the operation level.</p> <p>Operation level bindings</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  # bindings defined at the test level are available to all steps and operations\n  bindings:\n  - name: hello\n    value: hello\n  steps:\n  - bindings:\n    - name: chainsaw\n      value: chainsaw\n    try:\n    - script:\n        bindings:\n        # `greetings` depends on `$hello` and `$chainsaw` bindings defined at the higher levels\n        - name: greetings\n          value: (join(' ', [$hello, $chainsaw]))\n        # custom environment variables, defined using custom bindings\n        env:\n        - name: GREETINGS\n          value: ($greetings)\n        content: echo $GREETINGS\n        check:\n          ($error): ~\n          ($stdout): hello chainsaw\n</code></pre>"},{"location":"blog/","title":"Blog","text":""},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/","title":"How to Perform Efficient E2E Testing with Chainsaw","text":""},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/#introduction","title":"Introduction","text":"<p>Chainsaw is a powerful tool that enables efficient end-to-end (E2E) testing, making it an essential asset for software developers. Built to be stronger and more cohesive than KUTTL, Chainsaw offers a superior suite of features for Kubernetes (k8s) operators and objects. In this blog post, we will explore how to leverage Chainsaw for efficient E2E testing and enhance your overall testing workflow. Let's dive in!</p>"},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/#table-of-contents","title":"Table of Contents","text":"<ul> <li>How to Perform Efficient E2E Testing with Chainsaw</li> <li>Introduction</li> <li>Table of Contents<ul> <li>Section 1: Installing Chainsaw</li> <li>1.1 Downloading Chainsaw</li> <li>1.2 Installing Chainsaw</li> <li>Section 2: Writing Configurations</li> <li>2.1 Understanding Chainsaw Configurations</li> <li>2.2 Writing Chainsaw Configurations</li> <li>Section 3: Creating Tests</li> <li>3.1 Understanding Chainsaw Tests</li> <li>3.2 Creating Chainsaw Tests</li> <li>Section 4: Running Tests</li> <li>4.1 Preparing for Test Execution</li> <li>4.2 Executing Tests in Chainsaw</li> <li>Conclusion</li> </ul> </li> </ul>"},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/#section-1-installing-chainsaw","title":"Section 1: Installing Chainsaw","text":""},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/#11-downloading-chainsaw","title":"1.1 Downloading Chainsaw","text":"<p>To get started with Chainsaw, you'll first need to download the appropriate release for your operating system and architecture. The releases are available on the official GitHub page at the following link: Release</p> <p>Here's a breakdown of the available releases:</p> <ul> <li>For macOS (Darwin) Users:</li> <li>Intel-based Macs: <code>chainsaw_darwin_amd64.tar.gz</code></li> <li> <p>Apple Silicon Macs: <code>chainsaw_darwin_arm64.tar.gz</code></p> </li> <li> <p>For Linux Users:</p> </li> <li>32-bit: <code>chainsaw_linux_386.tar.gz</code></li> <li>64-bit (AMD): <code>chainsaw_linux_amd64.tar.gz</code></li> <li>64-bit (ARM): <code>chainsaw_linux_arm64.tar.gz</code></li> </ul> <p>Each release also comes with associated .pem, .sbom, .sbom.pem, and .sig files. These are used for verification and security purposes. If you're interested in verifying the integrity of your download, you can use these files. However, for the purpose of this guide, we'll focus on the main .tar.gz files.</p>"},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/#12-installing-chainsaw","title":"1.2 Installing Chainsaw","text":"<p>Once you've downloaded the appropriate .tar.gz file for your system, you can proceed with the installation. Here's a step-by-step guide:</p> <ul> <li>Extract the Tarball:</li> </ul> <pre><code>tar -xzf chainsaw_&lt;your_version_and_architecture&gt;.tar.gz\n</code></pre> <ul> <li>Move the Extracted Binary:</li> </ul> <pre><code>sudo mv chainsaw /usr/local/bin/\n</code></pre> <ul> <li>Verify the Installation:</li> </ul> <pre><code>chainsaw --version\n</code></pre>"},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/#section-2-writing-configurations","title":"Section 2: Writing Configurations","text":""},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/#21-understanding-chainsaw-configurations","title":"2.1 Understanding Chainsaw Configurations","text":"<p>Chainsaw is a robust tool for end-to-end (e2e) testing in Kubernetes environments. It offers a flexible configuration system that allows users to define their testing parameters and conditions. The configuration can be set up in two primary ways:</p> <ul> <li>Configuration File: This is a structured file where you can define all your testing parameters.</li> <li>Command-line Flags: These are options you can pass directly when running Chainsaw commands. If both a configuration file and command-line flags are provided, the flags will override the settings in the configuration file.</li> </ul> <p>Chainsaw follows a hierarchy in loading its configurations:</p> <ol> <li>User-specified Configuration: If you provide a configuration file explicitly using a command-line flag.</li> <li>Default Configuration File: If no configuration is specified, Chainsaw will search for a default file named .chainsaw.yaml in the current directory.</li> <li>Internal Default Configuration: If neither of the above is available, Chainsaw will resort to a default configuration embedded within its binary.</li> </ol> <p>To specify a custom configuration, use the following command:</p> <pre><code>chainsaw test --config path/to/your/config.yaml\n</code></pre>"},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/#22-writing-chainsaw-configurations","title":"2.2 Writing Chainsaw Configurations","text":"<p>When writing a configuration for Chainsaw, you'll be working with a YAML file. Here's a basic example of what this might look like:</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Configuration\nmetadata:\n  name: custom-config\nspec:\n  timeout: 45s\n  skipDelete: false\n  failFast: true\n  parallel: 4\n  # ... other configurations\n</code></pre> <p>The full structure of the configuration file, including all possible fields and their descriptions, can be found in the Configuration API reference.</p> <p>If you don't provide a custom configuration, Chainsaw will use its default:</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Configuration\nmetadata:\n  name: default\nspec: {}\n</code></pre> <p>You can also override specific configurations using command-line flags, even after loading a configuration file. For instance:</p> <pre><code>chainsaw test --config path/to/your/config.yaml --timeout 45s --parallel 4\n</code></pre> <p>In this example, even if the configuration file specifies different values for <code>timeout</code> and <code>parallel</code>, the command-line flags will take precedence.</p> <p>For a comprehensive list of all supported flags and their descriptions, refer to the Chainsaw test command reference.</p>"},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/#section-3-creating-tests","title":"Section 3: Creating Tests","text":""},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/#31-understanding-chainsaw-tests","title":"3.1 Understanding Chainsaw Tests","text":"<p>In Chainsaw, a test is essentially an ordered sequence of test steps. These steps are executed sequentially, and if any step fails, the entire test is considered failed. Each test step can consist of multiple operations, such as creating, updating, or deleting resources in a Kubernetes cluster, or asserting that certain conditions are met.</p> <p>Chainsaw supports three primary test definition mechanisms:</p> <ul> <li>Manifests based syntax: This is a straightforward method where you provide Kubernetes resource manifests. Chainsaw uses these manifests to create, update, or assert expectations against a cluster.</li> <li>TestSteps based syntax: A more verbose method that offers flexibility in defining each test step. It allows for additional configurations and can be combined with the Manifests based syntax.</li> <li>Test based syntax: The most explicit method that provides a comprehensive overview of the test. It doesn't rely on file naming conventions and offers flexibility at both the test and test step levels.</li> </ul>"},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/#32-creating-chainsaw-tests","title":"3.2 Creating Chainsaw Tests","text":"<p>Creating tests in Chainsaw requires a clear understanding of the test definition mechanisms. Here's a detailed guide for each syntax:</p> <ol> <li>Using Manifests based syntax</li> </ol> <p>File Naming: Files should follow the convention <code>&lt;step index&gt;-&lt;name|assert|error&gt;.yaml</code>. For instance, <code>00-configmap.yaml</code> for resource creation, <code>01-assert.yaml</code> for assertions, and <code>02-error.yaml</code> for expected errors.</p> <p>Example:</p> <pre><code># 00-configmap.yaml\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: chainsaw-example\ndata:\n  key: value\n</code></pre> <ol> <li> <p>Using TestSteps based syntax</p> <p>Define a TestStep: Create a YAML file that defines a <code>TestStep</code> resource. This resource should specify operations like <code>Apply</code>, <code>Assert</code>, <code>Delete</code>, and <code>Error</code>.</p> </li> </ol> <p>Example:</p> <pre><code># 01-test-step.yaml\napiVersion: chainsaw.kyverno.io/v1alpha1\nkind: TestStep\nmetadata:\n  name: apply-configmap-step\nspec:\n  apply:\n  - file: /resources/configmap.yaml\n</code></pre> <p>You can combine TestStep resources with raw Kubernetes manifests. For instance, a TestStep might apply a resource, while a separate manifest file makes assertions about that resource.</p> <p>Example:</p> <pre><code># 02-assert.yaml\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: chainsaw-example\ndata:\n  key: value\n</code></pre> <ol> <li>Using Test based syntax</li> </ol> <p>Define a Test: Start by creating a YAML file that defines a Test resource. This resource will have a spec section that outlines the entire test.</p> <p>Example:</p> <pre><code># chainsaw-test.yaml\napiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: full-test-example\nspec:\n  timeout: 10s\n  steps:\n  - spec:\n      apply:\n      - file: /resources/configmap.yaml\n  - spec:\n      assert:\n      - file: /resources/configmap-assert.yaml\n</code></pre> <p>Chainsaw processes the test by executing each step in sequence, ensuring that your Kubernetes environment meets the defined conditions.</p>"},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/#section-4-running-tests","title":"Section 4: Running Tests","text":""},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/#41-preparing-for-test-execution","title":"4.1 Preparing for Test Execution","text":"<p>Before executing your tests, ensure that:</p> <ol> <li>Kubernetes Cluster: You have access to a Kubernetes cluster where the tests will run. This could be a local cluster (like Minikube or kind) or a remote one.</li> <li>Kubeconfig: Your <code>kubeconfig</code> is correctly set up to point to the desired cluster. Chainsaw will use the current context from your <code>kubeconfig</code> to interact with the cluster.</li> <li>Test Files: All your test files, whether they are written using Manifests based, <code>TestSteps</code> based, or <code>Test</code> based syntax, are organized and accessible.</li> </ol>"},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/#42-executing-tests-in-chainsaw","title":"4.2 Executing Tests in Chainsaw","text":"<p>Once you're set up, running tests in Chainsaw is straightforward:</p> <ol> <li>Navigate to the Test Directory:</li> </ol> <pre><code>cd path/to/your/test/directory\n</code></pre> <ol> <li>Run the Tests:</li> </ol> <pre><code>chainsaw test\n</code></pre> <p>This command will execute all tests in the current directory.</p> <ol> <li>View the Results: Chainsaw will display the results in the terminal. It provides a summary of passed, failed, and skipped tests. For any failed tests, Chainsaw will display detailed error messages to help diagnose the issue.</li> </ol> <p>The output will resemble:</p> <pre><code>Loading default configuration...\n...\nRunning tests...\n=== RUN   quick-start\n...\n--- PASS: quick-start (5.22s)\nPASS\nTests Summary...\n- Passed  tests: 3\n- Failed  tests: 1\n- Skipped tests: 2\nDone.\n</code></pre>"},{"location":"blog/How-to-Perform-Efficient-E2E-Testing-with-Chainsaw/#conclusion","title":"Conclusion","text":"<p>Chainsaw provides a robust and flexible framework for end-to-end testing in Kubernetes environments. By understanding its configuration and test definition mechanisms, developers can create comprehensive test suites that ensure their Kubernetes applications and configurations are functioning as expected.</p>"},{"location":"blog/first-test/","title":"First working test !","text":"<p>First test run !</p> <p>The quick start test is passing </p> <pre><code># define kind image\nexport KIND_IMAGE=\"kindest/node:v1.28.0\"\n\n# create cluster\nkind create cluster --image $KIND_IMAGE\n\n# create test folder\nmkdir quick-start\n\n# enter test folder\ncd quick-start\n\n# create a ConfigMap\ncat &gt; configmap.yaml &lt;&lt; EOF\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: chainsaw-quick-start\ndata:\n  foo: bar\nEOF\n\n# create test file\ncat &gt; chainsaw-test.yaml &lt;&lt; EOF\napiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: quick-start\nspec:\n  steps:\n  # first step applies the config map\n  - apply:\n    # file is relative to the test folder\n    - file: configmap.yaml\n  # second step verifies the config map exists and contains the expected data\n  - assert:\n    # file is relative to the test folder\n    - file: configmap.yaml\nEOF\n\n../chainsaw test --test-dir .\n\nRunning without configuration\nLoading tests...\n- quick-start (.)\nRunning tests...\n=== RUN   chainsaw\n=== RUN   chainsaw/quick-start\n=== PAUSE chainsaw/quick-start\n=== CONT  chainsaw/quick-start\n    runner.go:35: step-1\n    runner.go:35: apply chainsaw-polite-chamois/chainsaw-quick-start (v1/ConfigMap)\n    runner.go:35: step-2\n    runner.go:35: assert chainsaw-polite-chamois/chainsaw-quick-start (v1/ConfigMap)\n    runner.go:68: cleanup namespace: chainsaw-polite-chamois\n--- PASS: chainsaw (0.00s)\n    --- PASS: chainsaw/quick-start (5.09s)\nPASS\nDone.\n</code></pre> <p>Impressive ! </p>"},{"location":"blog/wip/","title":"It's happening - Finally !","text":"<p>Hello everyone!</p> <p>We finally started writing our own testing tool !</p> <p>Let's join forces and make better, stronger Open Source and Community Driven tool.</p>"},{"location":"blog/wip/#why-we-made-it","title":"Why we made it ?","text":"<p>While developing Kyverno we needed to run end to end tests to make sure our admission controller worked as expected.</p> <p>Kyverno can validate, mutate and generate resources based on policies installed in a cluster and a typical test is:</p> <ol> <li>Create a policy</li> <li>Create a resource</li> <li>Check that Kyverno acted as expected</li> <li>Cleanup and move to the next test</li> </ol> <p>We started with another tool called KUTTL. While KUTTL is great we identified some limitations and forked the tool to add the features we needed.</p> <p>At some point we needed more flexibility than what KUTTL offered and we designed a new assertion model.</p> <p>This was simpler to start from scratch than continuing making changes in our KUTTL fork.</p>"},{"location":"blog/wip/#whats-next","title":"What's next ?","text":"<p>This is still WIP and needs a lot of work before we can consider it ready but things are moving fast.</p> <p>We would love to build a community driven tool and welcome all contributors.</p> <p>Feel free to fork this repository and start submitting pull requests </p>"},{"location":"collectors/","title":"Collectors","text":""},{"location":"collectors/#purpose","title":"Purpose","text":"<p>The purpose of collectors is to collect certain information about the outcome of a step should it fail (in the case of <code>catch</code>) or at the end of the step (in the case of <code>finally</code>).</p> <p>The ultimate goal of collectors is to gather information about the failure of a step and therefore help understand what caused it to fail.</p> <p>A test step can have an arbitrary number of collectors.</p>"},{"location":"collectors/#available-collectors","title":"Available collectors","text":"<ul> <li>Pod logs</li> <li>Events</li> <li>Get</li> <li>Describe</li> </ul>"},{"location":"collectors/describe/","title":"Describe","text":"<p>Describing resources present in the cluster can help understand what happened and troubleshoot test failures.</p>"},{"location":"collectors/describe/#configuration","title":"Configuration","text":"<p>The full structure of the <code>Describe</code> resource is documented here.</p>"},{"location":"collectors/describe/#describe-pods","title":"Describe pods","text":"<p>If a <code>name</code> is specified, Chainsaw will describe resources that have a name starting with the provided <code>name</code> in the test namespace (or in the cluster if it is a clustered-level resource).</p> <p>Describe pods in the test namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - describe:\n        resource: pods\n        name: my-pod\n    # ...\n    finally:\n    - describe:\n        resource: pods\n        name: my-pod\n    # ...\n</code></pre> <p>If a <code>namespace</code> is specified, Chainsaw will describe resources in the specified namespace.</p> <p>Describe pods in a specific namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - describe:\n        resource: pods\n        namespace: foo\n    # ...\n    finally:\n    - describe:\n        resource: pods\n        namespace: foo\n    # ...\n</code></pre>"},{"location":"collectors/describe/#label-selector","title":"Label selector","text":"<p>An optional label selector can be configured to refine the resources to be described.</p> <p>Describe pods using a label selector in the test namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - describe:\n        resource: pods\n        selector: app=my-app\n    # ...\n    finally:\n    - describe:\n        resource: pods\n        selector: app=my-app\n    # ...\n</code></pre> <p>If a <code>namespace</code> is specified, Chainsaw will describe resources in the specified namespace.</p> <p>Describe pods using a label selector in a specific namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - describe:\n        resource: pods\n        selector: app=my-app\n        namespace: foo\n    # ...\n    finally:\n    - describe:\n        resource: pods\n        selector: app=my-app\n        namespace: foo\n    # ...\n</code></pre>"},{"location":"collectors/describe/#show-events","title":"Show events","text":"<p>The <code>showEvents</code> field can be used to enable or disable showing events when describing resources.</p> <p>Default</p> <p>By default, <code>showEvents</code>is <code>true</code>.</p> <p>Do not show events</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - describe:\n        resource: pods\n        namespace: foo\n        showEvents: false\n    # ...\n    finally:\n    - describe:\n        resource: pods\n        namespace: foo\n        showEvents: false\n    # ...\n</code></pre>"},{"location":"collectors/events/","title":"Events","text":"<p>Collecting namespace events can help understand what happened inside the cluster.</p>"},{"location":"collectors/events/#configuration","title":"Configuration","text":"<p>The full structure of the <code>Events</code> resource is documented here.</p>"},{"location":"collectors/events/#single-event","title":"Single event","text":"<p>If a <code>name</code> is specified, Chainsaw will retrieve the specified event in the test namespace.</p> <p>Collect event in the test namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - events:\n        name: my-event\n    # ...\n    finally:\n    - events:\n        name: my-event\n    # ...\n</code></pre> <p>If a <code>namespace</code> is specified, Chainsaw will retrieve the specified event in the specified namespace.</p> <p>Collect event in a specific namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - events:\n        name: my-event\n        namespace: foo\n    # ...\n    finally:\n    - events:\n        name: my-event\n        namespace: foo\n    # ...\n</code></pre>"},{"location":"collectors/events/#all-events","title":"All events","text":"<p>If no <code>name</code> and <code>namespace</code> are specified, Chainsaw will retrieve all events in the test namespace.</p> <p>Collect all events in the test namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - events: {}\n    # ...\n    finally:\n    - events: {}\n    # ...\n</code></pre> <p>On the other hand, if a <code>namespace</code> is specified, Chainsaw will retrieve all events in the specified namespace.</p> <p>Collect all events in a specific namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - events:\n        namespace: foo\n    # ...\n    finally:\n    - events:\n        namespace: foo\n    # ...\n</code></pre>"},{"location":"collectors/events/#label-selector","title":"Label selector","text":"<p>An optional label selector can be configured to refine the events to be retrieved.</p> <p>Collect events using a label selector in the test namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - events:\n        selector: app=my-app\n    # ...\n    finally:\n    - events:\n        selector: app=my-app\n    # ...\n</code></pre> <p>If a <code>namespace</code> is specified, Chainsaw will retrieve events using the specified namespace.</p> <p>Collect events using a label selector in a specific namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - events:\n        selector: app=my-app\n        namespace: foo\n    # ...\n    finally:\n    - events:\n        selector: app=my-app\n        namespace: foo\n    # ...\n</code></pre>"},{"location":"collectors/events/#format","title":"Format","text":"<p>An optional <code>format</code> can be specified. Supported formats are <code>json</code> and <code>yaml</code>.</p> <p>If <code>format</code> is not specified, results will be returned in text format.</p> <p>Use json format</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - events:\n        format: json\n    # ...\n    finally:\n    - events:\n        format: json\n    # ...\n</code></pre> <p>Use yaml format</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - events:\n        format: yaml\n    # ...\n    finally:\n    - events:\n        format: yaml\n    # ...\n</code></pre>"},{"location":"collectors/get/","title":"Get","text":"<p>The <code>get</code> collector is used to list and print resources in the cluster.</p>"},{"location":"collectors/get/#configuration","title":"Configuration","text":"<p>The full structure of the <code>Get</code> resource is documented here.</p>"},{"location":"collectors/get/#single-resource","title":"Single resource","text":"<p>If a <code>name</code> is specified, Chainsaw will retrieve the specified resource in the test namespace.</p> <p>Get pod in the test namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - get:\n        resource: pods\n        name: my-pod\n    # ...\n    finally:\n    - get:\n        resource: pods\n        name: my-pod\n    # ...\n</code></pre> <p>If a <code>namespace</code> is specified, Chainsaw will retrieve the specified resource in the specified namespace.</p> <p>Collect pod in a specific namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - get:\n        resource: pods\n        name: my-pod\n        namespace: foo\n    # ...\n    finally:\n    - get:\n        resource: pods\n        name: my-pod\n        namespace: foo\n    # ...\n</code></pre>"},{"location":"collectors/get/#all-resources","title":"All resources","text":"<p>If no <code>name</code> and <code>namespace</code> are specified, Chainsaw will retrieve all resources in the test namespace.</p> <p>Collect all resources in the test namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - get:\n        resource: pods\n    # ...\n    finally:\n    - get:\n        resource: pods\n    # ...\n</code></pre> <p>On the other hand, if a <code>namespace</code> is specified, Chainsaw will retrieve all resources in the specified namespace.</p> <p>Collect all resources in a specific namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - get:\n        resource: pods\n        namespace: foo\n    # ...\n    finally:\n    - get:\n        resource: pods\n        namespace: foo\n    # ...\n</code></pre>"},{"location":"collectors/get/#label-selector","title":"Label selector","text":"<p>An optional label selector can be configured to refine the resources to be retrieved.</p> <p>Collect resources using a label selector in the test namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - get:\n        resource: pods\n        selector: app=my-app\n    # ...\n    finally:\n    - get:\n        resource: pods\n        selector: app=my-app\n    # ...\n</code></pre> <p>If a <code>namespace</code> is specified, Chainsaw will retrieve resources using the specified namespace.</p> <p>Collect resources using a label selector in a specific namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - get:\n        resource: pods\n        selector: app=my-app\n        namespace: foo\n    # ...\n    finally:\n    - get:\n        resource: pods\n        selector: app=my-app\n        namespace: foo\n    # ...\n</code></pre>"},{"location":"collectors/get/#format","title":"Format","text":"<p>An optional <code>format</code> can be specified. Supported formats are <code>json</code> and <code>yaml</code>.</p> <p>If <code>format</code> is not specified, results will be returned in text format.</p> <p>Use json format</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - get:\n        resource: pods\n        format: json\n    # ...\n    finally:\n    - get:\n        resource: pods\n        format: json\n    # ...\n</code></pre> <p>Use yaml format</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - get:\n        resource: pods\n        format: yaml\n    # ...\n    finally:\n    - get:\n        resource: pods\n        format: yaml\n    # ...\n</code></pre>"},{"location":"collectors/pod-logs/","title":"Pod logs","text":"<p>Collecting pod logs can help understand what happened inside one or more pods.</p>"},{"location":"collectors/pod-logs/#configuration","title":"Configuration","text":"<p>The full structure of the <code>PodLogs</code> resource is documented here.</p>"},{"location":"collectors/pod-logs/#single-pod","title":"Single pod","text":"<p>If a pod <code>name</code> is specified, Chainsaw will retrieve logs from this specific pod in the test namespace.</p> <p>Collect pod logs in the test namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - podLogs:\n        name: my-pod\n    # ...\n    finally:\n    - podLogs:\n        name: my-pod\n    # ...\n</code></pre> <p>If a <code>namespace</code> is specified, Chainsaw will retrieve logs from this specific pod in the specified namespace.</p> <p>Collect pod logs in a specific namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - podLogs:\n        name: my-pod\n        namespace: foo\n    # ...\n    finally:\n    - podLogs:\n        name: my-pod\n        namespace: foo\n    # ...\n</code></pre>"},{"location":"collectors/pod-logs/#all-pods","title":"All pods","text":"<p>If no pod <code>name</code> and <code>namespace</code> is specified, Chainsaw will retrieve logs from all pods in the test namespace.</p> <p>Collect all pod logs in the test namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - podLogs: {}\n    # ...\n    finally:\n    - podLogs: {}\n    # ...\n</code></pre> <p>On the other hand, if a <code>namespace</code> is specified, Chainsaw will retrieve logs from all pods in the specified namespace.</p> <p>Collect all pod logs in a specific namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - podLogs:\n        namespace: foo\n    # ...\n    finally:\n    - podLogs:\n        namespace: foo\n    # ...\n</code></pre>"},{"location":"collectors/pod-logs/#label-selector","title":"Label selector","text":"<p>An optional label selector can be configured to refine the pods to retrieve logs from.</p> <p>Collect pod logs using a label selector in the test namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - podLogs:\n        selector: app=my-app\n    # ...\n    finally:\n    - podLogs:\n        selector: app=my-app\n    # ...\n</code></pre> <p>If a <code>namespace</code> is specified, Chainsaw will retrieve pod logs using the specified namespace.</p> <p>Collect pod logs using a label selector in a specific namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - podLogs:\n        selector: app=my-app\n        namespace: foo\n    # ...\n    finally:\n    - podLogs:\n        selector: app=my-app\n        namespace: foo\n    # ...\n</code></pre>"},{"location":"collectors/pod-logs/#tail","title":"Tail","text":"<p>The <code>tail</code> field can be used to limit the amount of log lines retrieved when querying pod logs.</p> <p>Default</p> <p>By default, <code>tail</code> will be <code>10</code> when a label selector is used, and <code>all</code> if a pod <code>name</code> is specified.</p> <p>Tail example</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - podLogs:\n        selector: app=my-app\n        namespace: foo\n        tail: 30\n    # ...\n    finally:\n    - podLogs:\n        selector: app=my-app\n        namespace: foo\n        tail: 30\n    # ...\n</code></pre>"},{"location":"collectors/pod-logs/#container","title":"Container","text":"<p>The <code>container</code> field can be used to retrieve logs from a specific container in the pod.</p> <p>Default</p> <p>By default logs from all containers will be fetched.</p> <p>Container example</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    catch:\n    - podLogs:\n        selector: app=my-app\n        namespace: foo\n        container: nginx\n    # ...\n    finally:\n    - podLogs:\n        selector: app=my-app\n        namespace: foo\n        container: nginx\n    # ...\n</code></pre>"},{"location":"commands/chainsaw/","title":"Chainsaw","text":""},{"location":"commands/chainsaw/#chainsaw","title":"chainsaw","text":"<p>Stronger tool for e2e testing</p> <pre><code>chainsaw [flags]\n</code></pre>"},{"location":"commands/chainsaw/#options","title":"Options","text":"<pre><code>  -h, --help   help for chainsaw\n</code></pre>"},{"location":"commands/chainsaw/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw assert  - Evaluate assertion</li> <li>chainsaw build    - Build commands</li> <li>chainsaw completion  - Generate the autocompletion script for the specified shell</li> <li>chainsaw create  - Create Chainsaw resources</li> <li>chainsaw docs  - Generate reference documentation</li> <li>chainsaw export  - Export commands</li> <li>chainsaw lint  - Lint a file or read from standard input</li> <li>chainsaw migrate    - Migrate resources to Chainsaw</li> <li>chainsaw test  - Run tests</li> <li>chainsaw version    - Print the version informations</li> </ul>"},{"location":"commands/chainsaw_assert/","title":"Chainsaw assert","text":""},{"location":"commands/chainsaw_assert/#chainsaw-assert","title":"chainsaw assert","text":"<p>Evaluate assertion</p> <pre><code>chainsaw assert [flags] [FILE]\n</code></pre>"},{"location":"commands/chainsaw_assert/#options","title":"Options","text":"<pre><code>      --clustered                           Defines if the resource is clustered (only applies when resource is loaded from a file)\n  -f, --file string                         Path to the file to assert or '-' to read from stdin\n  -h, --help                                help for assert\n      --kube-as string                      Username to impersonate for the operation\n      --kube-as-group stringArray           Group to impersonate for the operation, this flag can be repeated to specify multiple groups.\n      --kube-as-uid string                  UID to impersonate for the operation\n      --kube-certificate-authority string   Path to a cert file for the certificate authority\n      --kube-client-certificate string      Path to a client certificate file for TLS\n      --kube-client-key string              Path to a client key file for TLS\n      --kube-cluster string                 The name of the kubeconfig cluster to use\n      --kube-context string                 The name of the kubeconfig context to use\n      --kube-disable-compression            If true, opt-out of response compression for all requests to the server\n      --kube-insecure-skip-tls-verify       If true, the server's certificate will not be checked for validity. This will make your HTTPS connections insecure\n  -n, --kube-namespace string               If present, the namespace scope for this CLI request\n      --kube-password string                Password for basic authentication to the API server\n      --kube-proxy-url string               If provided, this URL will be used to connect via proxy\n      --kube-request-timeout string         The length of time to wait before giving up on a single server request. Non-zero values should contain a corresponding time unit (e.g. 1s, 2m, 3h). A value of zero means don't timeout requests. (default \"0\")\n      --kube-server string                  The address and port of the Kubernetes API server\n      --kube-tls-server-name string         If provided, this name will be used to validate server certificate. If this is not provided, hostname used to contact the server is used.\n      --kube-token string                   Bearer token for authentication to the API server\n      --kube-user string                    The name of the kubeconfig user to use\n      --kube-username string                Username for basic authentication to the API server\n      --namespace string                    Namespace to use (default \"default\")\n      --no-color                            Removes output colors\n  -r, --resource string                     Path to the file containing the resource\n      --timeout duration                    The assert timeout to use (default 30s)\n</code></pre>"},{"location":"commands/chainsaw_assert/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw    - Stronger tool for e2e testing</li> </ul>"},{"location":"commands/chainsaw_build/","title":"Chainsaw build","text":""},{"location":"commands/chainsaw_build/#chainsaw-build","title":"chainsaw build","text":"<p>Build commands</p> <pre><code>chainsaw build [flags]\n</code></pre>"},{"location":"commands/chainsaw_build/#options","title":"Options","text":"<pre><code>  -h, --help   help for build\n</code></pre>"},{"location":"commands/chainsaw_build/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw    - Stronger tool for e2e testing</li> <li>chainsaw build docs  - Build tests documentation</li> </ul>"},{"location":"commands/chainsaw_build_docs/","title":"Chainsaw build docs","text":""},{"location":"commands/chainsaw_build_docs/#chainsaw-build-docs","title":"chainsaw build docs","text":"<p>Build tests documentation</p> <pre><code>chainsaw build docs [flags]\n</code></pre>"},{"location":"commands/chainsaw_build_docs/#options","title":"Options","text":"<pre><code>      --catalog string         Path to the built test catalog file\n  -h, --help                   help for docs\n      --readme-file string     Name of the built docs file (default \"README.md\")\n      --test-dir stringArray   Directories containing test cases to run\n      --test-file string       Name of the test file (default \"chainsaw-test\")\n</code></pre>"},{"location":"commands/chainsaw_build_docs/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw build    - Build commands</li> </ul>"},{"location":"commands/chainsaw_completion/","title":"Chainsaw completion","text":""},{"location":"commands/chainsaw_completion/#chainsaw-completion","title":"chainsaw completion","text":"<p>Generate the autocompletion script for the specified shell</p>"},{"location":"commands/chainsaw_completion/#synopsis","title":"Synopsis","text":"<p>Generate the autocompletion script for chainsaw for the specified shell. See each sub-command's help for details on how to use the generated script.</p>"},{"location":"commands/chainsaw_completion/#options","title":"Options","text":"<pre><code>  -h, --help   help for completion\n</code></pre>"},{"location":"commands/chainsaw_completion/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw    - Stronger tool for e2e testing</li> <li>chainsaw completion bash    - Generate the autocompletion script for bash</li> <li>chainsaw completion fish    - Generate the autocompletion script for fish</li> <li>chainsaw completion powershell    - Generate the autocompletion script for powershell</li> <li>chainsaw completion zsh  - Generate the autocompletion script for zsh</li> </ul>"},{"location":"commands/chainsaw_completion_bash/","title":"Chainsaw completion bash","text":""},{"location":"commands/chainsaw_completion_bash/#chainsaw-completion-bash","title":"chainsaw completion bash","text":"<p>Generate the autocompletion script for bash</p>"},{"location":"commands/chainsaw_completion_bash/#synopsis","title":"Synopsis","text":"<p>Generate the autocompletion script for the bash shell.</p> <p>This script depends on the 'bash-completion' package. If it is not installed already, you can install it via your OS's package manager.</p> <p>To load completions in your current shell session:</p> <pre><code>source &lt;(chainsaw completion bash)\n</code></pre> <p>To load completions for every new session, execute once:</p>"},{"location":"commands/chainsaw_completion_bash/#linux","title":"Linux:","text":"<pre><code>chainsaw completion bash &gt; /etc/bash_completion.d/chainsaw\n</code></pre>"},{"location":"commands/chainsaw_completion_bash/#macos","title":"macOS:","text":"<pre><code>chainsaw completion bash &gt; $(brew --prefix)/etc/bash_completion.d/chainsaw\n</code></pre> <p>You will need to start a new shell for this setup to take effect.</p> <pre><code>chainsaw completion bash\n</code></pre>"},{"location":"commands/chainsaw_completion_bash/#options","title":"Options","text":"<pre><code>  -h, --help              help for bash\n      --no-descriptions   disable completion descriptions\n</code></pre>"},{"location":"commands/chainsaw_completion_bash/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw completion  - Generate the autocompletion script for the specified shell</li> </ul>"},{"location":"commands/chainsaw_completion_fish/","title":"Chainsaw completion fish","text":""},{"location":"commands/chainsaw_completion_fish/#chainsaw-completion-fish","title":"chainsaw completion fish","text":"<p>Generate the autocompletion script for fish</p>"},{"location":"commands/chainsaw_completion_fish/#synopsis","title":"Synopsis","text":"<p>Generate the autocompletion script for the fish shell.</p> <p>To load completions in your current shell session:</p> <pre><code>chainsaw completion fish | source\n</code></pre> <p>To load completions for every new session, execute once:</p> <pre><code>chainsaw completion fish &gt; ~/.config/fish/completions/chainsaw.fish\n</code></pre> <p>You will need to start a new shell for this setup to take effect.</p> <pre><code>chainsaw completion fish [flags]\n</code></pre>"},{"location":"commands/chainsaw_completion_fish/#options","title":"Options","text":"<pre><code>  -h, --help              help for fish\n      --no-descriptions   disable completion descriptions\n</code></pre>"},{"location":"commands/chainsaw_completion_fish/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw completion  - Generate the autocompletion script for the specified shell</li> </ul>"},{"location":"commands/chainsaw_completion_powershell/","title":"Chainsaw completion powershell","text":""},{"location":"commands/chainsaw_completion_powershell/#chainsaw-completion-powershell","title":"chainsaw completion powershell","text":"<p>Generate the autocompletion script for powershell</p>"},{"location":"commands/chainsaw_completion_powershell/#synopsis","title":"Synopsis","text":"<p>Generate the autocompletion script for powershell.</p> <p>To load completions in your current shell session:</p> <pre><code>chainsaw completion powershell | Out-String | Invoke-Expression\n</code></pre> <p>To load completions for every new session, add the output of the above command to your powershell profile.</p> <pre><code>chainsaw completion powershell [flags]\n</code></pre>"},{"location":"commands/chainsaw_completion_powershell/#options","title":"Options","text":"<pre><code>  -h, --help              help for powershell\n      --no-descriptions   disable completion descriptions\n</code></pre>"},{"location":"commands/chainsaw_completion_powershell/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw completion  - Generate the autocompletion script for the specified shell</li> </ul>"},{"location":"commands/chainsaw_completion_zsh/","title":"Chainsaw completion zsh","text":""},{"location":"commands/chainsaw_completion_zsh/#chainsaw-completion-zsh","title":"chainsaw completion zsh","text":"<p>Generate the autocompletion script for zsh</p>"},{"location":"commands/chainsaw_completion_zsh/#synopsis","title":"Synopsis","text":"<p>Generate the autocompletion script for the zsh shell.</p> <p>If shell completion is not already enabled in your environment you will need to enable it.  You can execute the following once:</p> <pre><code>echo \"autoload -U compinit; compinit\" &gt;&gt; ~/.zshrc\n</code></pre> <p>To load completions in your current shell session:</p> <pre><code>source &lt;(chainsaw completion zsh)\n</code></pre> <p>To load completions for every new session, execute once:</p>"},{"location":"commands/chainsaw_completion_zsh/#linux","title":"Linux:","text":"<pre><code>chainsaw completion zsh &gt; \"${fpath[1]}/_chainsaw\"\n</code></pre>"},{"location":"commands/chainsaw_completion_zsh/#macos","title":"macOS:","text":"<pre><code>chainsaw completion zsh &gt; $(brew --prefix)/share/zsh/site-functions/_chainsaw\n</code></pre> <p>You will need to start a new shell for this setup to take effect.</p> <pre><code>chainsaw completion zsh [flags]\n</code></pre>"},{"location":"commands/chainsaw_completion_zsh/#options","title":"Options","text":"<pre><code>  -h, --help              help for zsh\n      --no-descriptions   disable completion descriptions\n</code></pre>"},{"location":"commands/chainsaw_completion_zsh/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw completion  - Generate the autocompletion script for the specified shell</li> </ul>"},{"location":"commands/chainsaw_create/","title":"Chainsaw create","text":""},{"location":"commands/chainsaw_create/#chainsaw-create","title":"chainsaw create","text":"<p>Create Chainsaw resources</p> <pre><code>chainsaw create [flags]\n</code></pre>"},{"location":"commands/chainsaw_create/#options","title":"Options","text":"<pre><code>  -h, --help   help for create\n</code></pre>"},{"location":"commands/chainsaw_create/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw    - Stronger tool for e2e testing</li> <li>chainsaw create test    - Create a Chainsaw test</li> </ul>"},{"location":"commands/chainsaw_create_test/","title":"Chainsaw create test","text":""},{"location":"commands/chainsaw_create_test/#chainsaw-create-test","title":"chainsaw create test","text":"<p>Create a Chainsaw test</p> <pre><code>chainsaw create test [flags]\n</code></pre>"},{"location":"commands/chainsaw_create_test/#options","title":"Options","text":"<pre><code>      --description   If set, adds description when applicable (default true)\n      --force         If set, existing test will be deleted if needed\n  -h, --help          help for test\n      --save          If set, created test will be saved\n</code></pre>"},{"location":"commands/chainsaw_create_test/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw create  - Create Chainsaw resources</li> </ul>"},{"location":"commands/chainsaw_docs/","title":"Chainsaw docs","text":""},{"location":"commands/chainsaw_docs/#chainsaw-docs","title":"chainsaw docs","text":"<p>Generate reference documentation</p> <pre><code>chainsaw docs [flags]\n</code></pre>"},{"location":"commands/chainsaw_docs/#options","title":"Options","text":"<pre><code>      --autogenTag      Determines if the generated docs should contain a timestamp (default true)\n  -h, --help            help for docs\n  -o, --output string   Output path (default \".\")\n      --website         Website version\n</code></pre>"},{"location":"commands/chainsaw_docs/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw    - Stronger tool for e2e testing</li> </ul>"},{"location":"commands/chainsaw_export/","title":"Chainsaw export","text":""},{"location":"commands/chainsaw_export/#chainsaw-export","title":"chainsaw export","text":"<p>Export commands</p> <pre><code>chainsaw export [flags]\n</code></pre>"},{"location":"commands/chainsaw_export/#options","title":"Options","text":"<pre><code>  -h, --help   help for export\n</code></pre>"},{"location":"commands/chainsaw_export/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw    - Stronger tool for e2e testing</li> <li>chainsaw export schemas  - Export JSON schemas</li> </ul>"},{"location":"commands/chainsaw_export_schemas/","title":"Chainsaw export schemas","text":""},{"location":"commands/chainsaw_export_schemas/#chainsaw-export-schemas","title":"chainsaw export schemas","text":"<p>Export JSON schemas</p> <pre><code>chainsaw export schemas [flags]\n</code></pre>"},{"location":"commands/chainsaw_export_schemas/#options","title":"Options","text":"<pre><code>  -h, --help   help for schemas\n</code></pre>"},{"location":"commands/chainsaw_export_schemas/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw export  - Export commands</li> </ul>"},{"location":"commands/chainsaw_lint/","title":"Chainsaw lint","text":""},{"location":"commands/chainsaw_lint/#chainsaw-lint","title":"chainsaw lint","text":"<p>Lint a file or read from standard input</p>"},{"location":"commands/chainsaw_lint/#synopsis","title":"Synopsis","text":"<p>Use chainsaw lint to lint a specific file or read from standard input for either test or configuration.</p> <pre><code>chainsaw lint [test|configuration] [flags]\n</code></pre>"},{"location":"commands/chainsaw_lint/#options","title":"Options","text":"<pre><code>  -f, --file string   Specify the file to lint or '-' for standard input\n  -h, --help          help for lint\n</code></pre>"},{"location":"commands/chainsaw_lint/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw    - Stronger tool for e2e testing</li> </ul>"},{"location":"commands/chainsaw_migrate/","title":"Chainsaw migrate","text":""},{"location":"commands/chainsaw_migrate/#chainsaw-migrate","title":"chainsaw migrate","text":"<p>Migrate resources to Chainsaw</p> <pre><code>chainsaw migrate [flags]\n</code></pre>"},{"location":"commands/chainsaw_migrate/#options","title":"Options","text":"<pre><code>  -h, --help   help for migrate\n</code></pre>"},{"location":"commands/chainsaw_migrate/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw    - Stronger tool for e2e testing</li> <li>chainsaw migrate kuttl    - Migrate KUTTL resources to Chainsaw</li> <li>chainsaw migrate tests    - Migrate test steps to test</li> </ul>"},{"location":"commands/chainsaw_migrate_kuttl/","title":"Chainsaw migrate kuttl","text":""},{"location":"commands/chainsaw_migrate_kuttl/#chainsaw-migrate-kuttl","title":"chainsaw migrate kuttl","text":"<p>Migrate KUTTL resources to Chainsaw</p> <pre><code>chainsaw migrate kuttl [flags]\n</code></pre>"},{"location":"commands/chainsaw_migrate_kuttl/#options","title":"Options","text":"<pre><code>  -h, --help   help for kuttl\n</code></pre>"},{"location":"commands/chainsaw_migrate_kuttl/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw migrate    - Migrate resources to Chainsaw</li> <li>chainsaw migrate kuttl config  - Migrate KUTTL config to Chainsaw</li> <li>chainsaw migrate kuttl tests    - Migrate KUTTL tests to Chainsaw</li> </ul>"},{"location":"commands/chainsaw_migrate_kuttl_config/","title":"Chainsaw migrate kuttl config","text":""},{"location":"commands/chainsaw_migrate_kuttl_config/#chainsaw-migrate-kuttl-config","title":"chainsaw migrate kuttl config","text":"<p>Migrate KUTTL config to Chainsaw</p> <pre><code>chainsaw migrate kuttl config [flags]\n</code></pre>"},{"location":"commands/chainsaw_migrate_kuttl_config/#options","title":"Options","text":"<pre><code>      --cleanup   If set, delete converted files\n  -h, --help      help for config\n      --save      If set, converted files will be saved\n</code></pre>"},{"location":"commands/chainsaw_migrate_kuttl_config/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw migrate kuttl    - Migrate KUTTL resources to Chainsaw</li> </ul>"},{"location":"commands/chainsaw_migrate_kuttl_tests/","title":"Chainsaw migrate kuttl tests","text":""},{"location":"commands/chainsaw_migrate_kuttl_tests/#chainsaw-migrate-kuttl-tests","title":"chainsaw migrate kuttl tests","text":"<p>Migrate KUTTL tests to Chainsaw</p> <pre><code>chainsaw migrate kuttl tests [flags]\n</code></pre>"},{"location":"commands/chainsaw_migrate_kuttl_tests/#options","title":"Options","text":"<pre><code>      --cleanup   If set, delete converted files\n  -h, --help      help for tests\n      --save      If set, converted files will be saved\n</code></pre>"},{"location":"commands/chainsaw_migrate_kuttl_tests/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw migrate kuttl    - Migrate KUTTL resources to Chainsaw</li> </ul>"},{"location":"commands/chainsaw_migrate_tests/","title":"Chainsaw migrate tests","text":""},{"location":"commands/chainsaw_migrate_tests/#chainsaw-migrate-tests","title":"chainsaw migrate tests","text":"<p>Migrate test steps to test</p> <pre><code>chainsaw migrate tests [flags]\n</code></pre>"},{"location":"commands/chainsaw_migrate_tests/#options","title":"Options","text":"<pre><code>      --cleanup   If set, delete converted files\n  -h, --help      help for tests\n      --save      If set, converted files will be saved\n</code></pre>"},{"location":"commands/chainsaw_migrate_tests/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw migrate    - Migrate resources to Chainsaw</li> </ul>"},{"location":"commands/chainsaw_test/","title":"Chainsaw test","text":""},{"location":"commands/chainsaw_test/#chainsaw-test","title":"chainsaw test","text":"<p>Run tests</p> <pre><code>chainsaw test [flags]... [test directories]...\n</code></pre>"},{"location":"commands/chainsaw_test/#options","title":"Options","text":"<pre><code>      --apply-timeout duration                    The apply timeout to use as default for configuration (default 5s)\n      --assert-timeout duration                   The assert timeout to use as default for configuration (default 30s)\n      --cleanup-delay duration                    Adds a delay between the time a test ends and the time cleanup starts\n      --cleanup-timeout duration                  The cleanup timeout to use as default for configuration (default 30s)\n      --cluster strings                           Register cluster (format &lt;cluster name&gt;=&lt;kubeconfig path&gt;:[context name])\n      --config string                             Chainsaw configuration file\n      --delete-timeout duration                   The delete timeout to use as default for configuration (default 15s)\n      --error-timeout duration                    The error timeout to use as default for configuration (default 30s)\n      --exclude-test-regex string                 Regular expression to exclude tests\n      --exec-timeout duration                     The exec timeout to use as default for configuration (default 5s)\n      --fail-fast                                 Stop the test upon encountering the first failure\n      --force-termination-grace-period duration   If specified, overrides termination grace periods in applicable resources\n      --full-name                                 Use full test case folder path instead of folder name\n  -h, --help                                      help for test\n      --include-test-regex string                 Regular expression to include tests\n      --kube-as string                            Username to impersonate for the operation\n      --kube-as-group stringArray                 Group to impersonate for the operation, this flag can be repeated to specify multiple groups.\n      --kube-as-uid string                        UID to impersonate for the operation\n      --kube-certificate-authority string         Path to a cert file for the certificate authority\n      --kube-client-certificate string            Path to a client certificate file for TLS\n      --kube-client-key string                    Path to a client key file for TLS\n      --kube-cluster string                       The name of the kubeconfig cluster to use\n      --kube-context string                       The name of the kubeconfig context to use\n      --kube-disable-compression                  If true, opt-out of response compression for all requests to the server\n      --kube-insecure-skip-tls-verify             If true, the server's certificate will not be checked for validity. This will make your HTTPS connections insecure\n  -n, --kube-namespace string                     If present, the namespace scope for this CLI request\n      --kube-password string                      Password for basic authentication to the API server\n      --kube-proxy-url string                     If provided, this URL will be used to connect via proxy\n      --kube-request-timeout string               The length of time to wait before giving up on a single server request. Non-zero values should contain a corresponding time unit (e.g. 1s, 2m, 3h). A value of zero means don't timeout requests. (default \"0\")\n      --kube-server string                        The address and port of the Kubernetes API server\n      --kube-tls-server-name string               If provided, this name will be used to validate server certificate. If this is not provided, hostname used to contact the server is used.\n      --kube-token string                         Bearer token for authentication to the API server\n      --kube-user string                          The name of the kubeconfig user to use\n      --kube-username string                      Username for basic authentication to the API server\n      --namespace string                          Namespace to use for tests\n      --no-cluster                                Runs without cluster\n      --no-color                                  Removes output colors\n      --parallel int                              The maximum number of tests to run at once\n      --repeat-count int                          Number of times to repeat each test (default 1)\n      --report-format string                      Test report format (JSON|XML|nil)\n      --report-name string                        The name of the report to create (default \"chainsaw-report\")\n      --report-path string                        The path of the report to create\n      --selector strings                          Selector (label query) to filter on\n      --skip-delete                               If set, do not delete the resources after running the tests\n      --template                                  If set, resources will be considered for templating\n      --test-dir strings                          Directories containing test cases to run\n      --test-file string                          Name of the test file (default \"chainsaw-test\")\n      --values strings                            Values passed to the tests\n</code></pre>"},{"location":"commands/chainsaw_test/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw    - Stronger tool for e2e testing</li> </ul>"},{"location":"commands/chainsaw_version/","title":"Chainsaw version","text":""},{"location":"commands/chainsaw_version/#chainsaw-version","title":"chainsaw version","text":"<p>Print the version informations</p> <pre><code>chainsaw version [flags]\n</code></pre>"},{"location":"commands/chainsaw_version/#options","title":"Options","text":"<pre><code>  -h, --help   help for version\n</code></pre>"},{"location":"commands/chainsaw_version/#see-also","title":"SEE ALSO","text":"<ul> <li>chainsaw    - Stronger tool for e2e testing</li> </ul>"},{"location":"configuration/","title":"Configuring Chainsaw","text":"<p>Chainsaw is a comprehensive tool designed to facilitate end-to-end testing in Kubernetes.</p> <p>This documentation will focus on providing a breakdown of its configuration structure and how to use it.</p> <p>Chainsaw can be configured in two different and complementary ways:</p> <ul> <li>Using a configuration file</li> <li>Overriding configuration with command-line flags</li> </ul> <p>Precedence</p> <p>If both are specified, command-line flags will take precedence over configuration coming from a configuration file.</p>"},{"location":"configuration/#specific-configuration-options","title":"Specific configuration options","text":"<p>Please pay attention to the configuration options below, they may or may not be relevant in your case but can be useful in certain cases:</p> <ul> <li>Timeouts</li> <li>Termination graceful period</li> <li>Delay before cleanup</li> <li>Creating test reports</li> <li>Label selectors</li> <li>Passing arbitrary values to tests</li> <li>Multi cluster</li> <li>Resource templating</li> <li>Running without a cluster</li> </ul>"},{"location":"configuration/cleanup-delay/","title":"Delay before cleanup","text":"<p>At the end of each test, Chainsaw will delete the resources it created during the test.</p> <p>When testing operators, it can be useful to wait a little bit before starting the cleanup process to make sure the operator/controller has the necessary time to update the internal state.</p> <p>For this reason, Chainsaw provides the <code>delayBeforeCleanup</code> configuration option and the corresponding <code>--delay-before-cleanup</code> flag.</p>"},{"location":"configuration/cleanup-delay/#configuration","title":"Configuration","text":"<pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Configuration\nmetadata:\n  name: custom-config\nspec:\n  # ...\n  delayBeforeCleanup: 5s\n  # ...\n</code></pre>"},{"location":"configuration/cleanup-delay/#flag","title":"Flag","text":"<pre><code>chainsaw test --delay-before-cleanup 5s ...\n</code></pre>"},{"location":"configuration/file/","title":"Configuration file","text":"<p>Chainsaw is described as a Stronger tool for e2e testing.</p> <p>With its versatile configuration options, you can customize the testing process to fit your needs.</p> <p>Chainsaw prioritizes its configuration in the following order:</p> <ol> <li> <p>User-specified configuration</p> <p>If you explicitly provide a configuration file using a command-line flag</p> </li> <li> <p>Default configuration file</p> <p>If no configuration is specified, Chainsaw will look for a default file named <code>.chainsaw.yaml</code> in the current working directory</p> </li> <li> <p>Internal default configuration</p> <p>In the absence of both the above, Chainsaw will use a default configuration file embedded in the Chainsaw binary</p> </li> </ol>"},{"location":"configuration/file/#example","title":"Example","text":"<pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Configuration\nmetadata:\n  name: custom-config\nspec:\n  timeouts:\n    apply: 45s\n    assert: 20s\n    cleanup: 45s\n    delete: 25s\n    error: 10s\n    exec: 45s\n  skipDelete: false\n  failFast: true\n  parallel: 4\n  # ...\n</code></pre>"},{"location":"configuration/file/#how-to-specify-a-configuration","title":"How to specify a configuration","text":"<p>To use a custom configuration file:</p> <pre><code>chainsaw test --config path/to/your/config.yaml\n</code></pre> <p>Defaults</p> <p>If you don't specify any configuration, Chainsaw will look for the default configuration file <code>.chainsaw.yaml</code> in the current working directory.</p> <p>If that file is not found, it will fall back to its internal default configuration.</p>"},{"location":"configuration/file/#default-configuration","title":"Default configuration","text":"<p>The default configuration below is used by Chainsaw when no configuration file was provided and the default file <code>.chainsaw.yaml</code> does not exist.</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Configuration\nmetadata:\n  name: default\nspec: {}\n</code></pre>"},{"location":"configuration/file/#reference-documentation","title":"Reference documentation","text":"<p>See Configuration API reference for more details.</p>"},{"location":"configuration/flags/","title":"Command line flags","text":"<p>Even after a configuration file is loaded, you can override specific settings using command-line flags.</p>"},{"location":"configuration/flags/#example","title":"Example","text":"<pre><code>chainsaw test                         \\\n    path/to/test/dir                    \\\n    --config path/to/your/config.yaml   \\\n    --assert-timeout 45s                \\\n    --skip-delete false                 \\\n    --fail-fast true                    \\\n    --parallel 4                        \\\n    ...\n</code></pre> <p>In this example, Chainsaw will load a configuration file but the timeout configuration and other settings will be overridden by the values set in the flags, regardless of the value in the loaded configuration file.</p>"},{"location":"configuration/flags/#usage","title":"Usage","text":"<p>The command below will run tests using the configuration from <code>my-config.yaml</code>, taking tests from <code>/path/to/tests</code>, and running a maximum of <code>10</code> tests simultaneously.</p> <pre><code>chainsaw test /path/to/tests --config my-config.yaml --parallel 10\n</code></pre>"},{"location":"configuration/flags/#reference-documentation","title":"Reference documentation","text":"<p>See Chainsaw test command reference for more details.</p>"},{"location":"configuration/grace/","title":"Termination graceful period","text":"<p>Some Kubernetes resources can take time before being stopped. For example, deleting a <code>Pod</code> can take time if the underlying container doesn't quit quickly enough.</p> <p>For this reason, Chainsaw provides the <code>forceTerminationGracePeriod</code> configuration option and the corresponding <code>--force-termination-grace-period</code> flag. If set, Chainsaw will override the <code>terminationGracePeriodSeconds</code> when working with the following resource kinds:</p> <ul> <li><code>Pod</code></li> <li><code>Deployment</code></li> <li><code>StatefulSet</code></li> <li><code>DaemonSet</code></li> <li><code>Job</code></li> <li><code>CronJob</code></li> </ul>"},{"location":"configuration/grace/#configuration","title":"Configuration","text":"<pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Configuration\nmetadata:\n  name: custom-config\nspec:\n  # ...\n  forceTerminationGracePeriod: 5s\n  # ...\n</code></pre>"},{"location":"configuration/grace/#flag","title":"Flag","text":"<pre><code>chainsaw test --force-termination-grace-period 5s ...\n</code></pre>"},{"location":"configuration/multi-cluster/","title":"Multi cluster","text":"<p>Chainsaw supports testing against multiple clusters.</p> <p>To use a specific cluster in a test (or test step) you will need to register the cluster either using the config file or using command line flags.</p>"},{"location":"configuration/multi-cluster/#configuration","title":"Configuration","text":"<pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Configuration\nmetadata:\n  name: custom-config\nspec:\n  # ...\n  clusters:\n    cluster-1:\n      kubeconfig: /path/to/kubeconfig-1\n      context: context-name\n    cluster-2:\n      kubeconfig: /path/to/kubeconfig-2\n      context: context-name\n  # ...\n</code></pre>"},{"location":"configuration/multi-cluster/#flag","title":"Flag","text":"<p>The <code>--cluster</code> flag can appear multiple times and is expected to come in the following format <code>--cluster cluster-name=/path/to/kubeconfig[:context-name]</code>.</p> <pre><code>chainsaw test                                               \\\n    --cluster cluster-1=/path/to/kubeconfig-1               \\\n    --cluster cluster-2=/path/to/kubeconfig-2:context-name\n</code></pre>"},{"location":"configuration/multi-cluster/#usage","title":"Usage","text":"<p>Once registered, a cluster can be specified at the <code>test</code>, <code>step</code> or <code>operation</code> level. If specified at multiple levels, the most granular one is selected, effectively overriding the cluster specified at higher levels.</p> <p>Specifying cluster at the test level</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  # all steps and operations will be executed against the\n  # cluster specified below (unless overridden)\n  cluster: cluster-1\n  steps:\n  - try:\n    # ...\n    - assert:\n        resource:\n          apiVersion: v1\n          kind: Deployment\n          metadata:\n            name: foo\n          spec:\n            (replicas &gt; 3): true\n    # ...\n</code></pre> <p>Specifying cluster at the step level</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - # all operations will be executed against the\n    # cluster specified below (unless overridden)\n    cluster: cluster-1\n    try:\n    # ...\n    - assert:\n        resource:\n          apiVersion: v1\n          kind: Deployment\n          metadata:\n            name: foo\n          spec:\n            (replicas &gt; 3): true\n    # ...\n</code></pre> <p>Specifying cluster at the operation level</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - assert:\n        # operation will be executed against the\n        # cluster specified below\n        cluster: cluster-1\n        resource:\n          apiVersion: v1\n          kind: Deployment\n          metadata:\n            name: foo\n          spec:\n            (replicas &gt; 3): true\n    # ...\n</code></pre>"},{"location":"configuration/multi-cluster/#client-binding","title":"<code>$client</code> binding","text":"<p>When a cluster is specified (whatever the <code>test</code>, <code>step</code> or <code>operation</code> level), the <code>$client</code> binding visible in operation expressions is always the Kubernetes client corresponding to the configured cluster.</p> <p>In the example below, <code>$client</code> binding is a client to the configured <code>cluster-1</code>.</p> <p><code>$client</code> binding</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - assert:\n        # operation will be executed against the\n        # cluster specified below\n        cluster: cluster-1\n        resource:\n          resource:\n            (x_k8s_list($client, 'v1', 'Node')):\n                (length(@)): 1\n    # ...\n</code></pre>"},{"location":"configuration/multi-cluster/#kubeconfig-in-scripts-and-commands","title":"KUBECONFIG in scripts and commands","text":"<p>When a cluster is specified (whatever the <code>test</code>, <code>step</code> or <code>operation</code> level), a temporary <code>KUBECONFIG</code> is automatically created and the <code>KUBECONFIG</code> is set to this temporary file for every <code>command</code> and <code>script</code> operation.</p> <p>This way <code>command</code> and <code>script</code> operations are executed in the context of the configured cluster.</p> <p>Temporary KUBECONFIG</p> <p>The default <code>KUBECONFIG</code> you usually observe in your local shell will be different in <code>script</code> and <code>command</code> operations.</p> <p>Temporary KUBECONFIG</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - script:\n        # operation will be executed against the\n        # cluster specified below\n        cluster: cluster-1\n        # the kubectl command below will use a \n        # KUBECONFIG environment variable pointing\n        # to a temporary kubeconfig file configured\n        # for the specified cluster\n        content: kubectl get pods\n    # ...\n</code></pre>"},{"location":"configuration/no-cluster/","title":"Running without a cluster","text":"<p>Chainsaw can be run without connection to a Kubernetes cluster. In this case, chainsaw will not try to create an ephemeral namespace and all operations requiring a Kubernetes cluster will fail.</p> <p>To run chainsaw in this mode pass the <code>--no-cluster</code> flag.</p>"},{"location":"configuration/no-cluster/#example","title":"Example","text":"<pre><code># run chainsaw without connection to a Kubernetes cluster\nchainsaw test --no-cluster\n</code></pre>"},{"location":"configuration/reports/","title":"Reports","text":"<p>Chainsaw can generate JUnit reports in <code>XML</code> or <code>JSON</code> format.</p> <p>To produce a test report, configure the report format, report path and report name in the configuration or using CLI flags.</p>"},{"location":"configuration/reports/#configuration","title":"Configuration","text":"<pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Configuration\nmetadata:\n  name: custom-config\nspec:\n  # ...\n  reportFormat: JSON\n  reportName: chainsaw-report\n  reportPath: /home/chainsaw\n  # ...\n</code></pre>"},{"location":"configuration/reports/#flag","title":"Flag","text":"<pre><code>chainsaw test --report-format JSON --report-name chainsaw-report --report-path /path/to/save/report ...\n</code></pre> <p>Note: The reportPath can be specified as either a relative or an absolute path.</p>"},{"location":"configuration/selector/","title":"Label selectors","text":"<p>Chainsaw can filter the tests to run using label selectors.</p> <p>You can pass label selectors using the <code>--selector</code> flag when invoking the <code>chainsaw test</code> command.</p>"},{"location":"configuration/selector/#example","title":"Example","text":"<p>Given the test below:</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: basic\n  labels:\n    foo: bar\nspec:\n  # ...\n</code></pre> <p>Invoking Chainsaw with the command below will take the test above into account:</p> <pre><code>chainsaw test --selector foo=bar\n</code></pre>"},{"location":"configuration/templating/","title":"Resource templating","text":"<p>Experimental status</p> <p>This is an experimental feature, and implementation could change slightly in the next versions.</p> <p>Chainsaw can apply transformations to the resources before they are processed by the operation.</p> <p>This is useful when a resource needs some runtime configuration.</p> <p>Templating must be enabled at the configuration, test, step, or operation level for the templating process to kick in. Alternatively, templating can be enabled using the <code>--template</code> flag when invoking chainsaw from the command line.</p> <p>Note</p> <p>Unlike assertion trees, templating can only be specified in leave nodes of the YAML tree.</p>"},{"location":"configuration/templating/#example","title":"Example","text":"<p>The test below will create, assert, and delete a <code>ConfigMap</code> with a dynamic <code>name</code> configured at runtime using the <code>$namespace</code> binding.</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: values\nspec:\n  steps:\n  - try:\n    - apply:\n        resource:\n          apiVersion: v1\n          kind: ConfigMap\n          metadata:\n            name: ($namespace)\n    - assert:\n        resource:\n          apiVersion: v1\n          kind: ConfigMap\n          metadata:\n            name: ($namespace)\n    - delete:\n        ref:\n          apiVersion: v1\n          kind: ConfigMap\n          name: ($namespace)\n</code></pre>"},{"location":"configuration/timeouts/","title":"Timeouts","text":"<p>Timeouts in Chainsaw are specified per type of operation. This is required because the timeout varies greatly depending on the nature of an operation.</p> <p>For example, applying a manifest in a cluster is expected to be reasonably fast, while validating a resource can be a long operation.</p> <p>Chainsaw supports separately configuring the timeouts below:</p> <ul> <li> <p>Apply</p> <p>When Chainsaw applies manifests in a cluster</p> </li> <li> <p>Assert</p> <p>When Chainsaw validates resources in a cluster</p> </li> <li> <p>Cleanup</p> <p>When Chainsaw removes resources from a cluster created for a test</p> </li> <li> <p>Delete</p> <p>When Chainsaw deletes resources from a cluster</p> </li> <li> <p>Error</p> <p>When Chainsaw validates resources in a cluster</p> </li> <li> <p>Exec</p> <p>When Chainsaw executes arbitrary commands or scripts</p> </li> </ul> <p>Overriding timeouts</p> <p>Each timeout can be overridden at the test level, test step level, or individual operation level.</p> <p>Timeouts defined in the <code>Configuration</code> are used in operations when not overridden.</p>"},{"location":"configuration/timeouts/#configuration","title":"Configuration","text":"<pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Configuration\nmetadata:\n  name: custom-config\nspec:\n  # ...\n  timeouts:\n    apply: 45s\n    assert: 20s\n    cleanup: 45s\n    delete: 25s\n    error: 10s\n    exec: 45s\n  # ...\n</code></pre>"},{"location":"configuration/timeouts/#flag","title":"Flag","text":"<pre><code>chainsaw test                     \\\n    --apply-timeout 45s             \\\n    --assert-timeout 45s            \\\n    --cleanup-timeout 45s           \\\n    --delete-timeout 45s            \\\n    --error-timeout 45s             \\\n    --exec-timeout 45s              \\\n    ...\n</code></pre>"},{"location":"configuration/values/","title":"Passing data to tests","text":"<p>Chainsaw can pass arbitrary values when running tests using the <code>--values</code> flag. Values will be available to tests under the <code>$values</code> binding.</p> <p>This is useful when a test needs to be configured externally.</p>"},{"location":"configuration/values/#example","title":"Example","text":"<p>The test below expects the <code>$value.foo</code> to be provided when chainsaw is invoked.</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: values\nspec:\n  steps:\n  - try:\n    - assert:\n        resource:\n          ($values.foo): bar\n</code></pre> <p>Now you can invoke chainsaw like this:</p> <pre><code># pass object { \"foo\": \"bar\"\u00a0} as values to the executed tests\n# `--values -` means values are read from standard input\necho \"foo: bar\" | chainsaw test --values -\n\n# read values from a file\nchainsaw test --values ./values.yaml\n\n# pass values using heredoc\nchainsaw test --values - &lt;&lt;EOF\nfoo: bar\nEOF\n</code></pre>"},{"location":"examples/","title":"Setup","text":"<p>To use Chainsaw you will need a Kubernetes cluster, Chainsaw won't create one for you.</p> <p>In these examples, we will use kind but feel free to use the tool of your choice.</p> <p>Not a cluster management tool</p> <p>We consider this is not the responsibility of Chainsaw to manage clusters.</p> <p>There are plenty of solutions to create and manage local clusters that will do that better than Chainsaw.</p>"},{"location":"examples/#create-a-kind-cluster","title":"Create a kind cluster","text":"<p>Please refer to the kind install docs to install it locally.</p> <p>Once kind creating a local cluster is as simple as running:</p> <pre><code># define kind image\nexport KIND_IMAGE=\"kindest/node:v1.28.0\"\n\n# create cluster\nkind create cluster --image $KIND_IMAGE\n</code></pre>"},{"location":"examples/#install-chainsaw","title":"Install Chainsaw","text":"<p>Refer to install docs to install Chainsaw.</p>"},{"location":"examples/array-assertions/","title":"Array assertions","text":"<p>This example demonstrates how to perform complex assertions on arrays.</p>"},{"location":"examples/array-assertions/#setup","title":"Setup","text":"<p>See Setup docs</p>"},{"location":"examples/array-assertions/#manifests","title":"Manifests","text":""},{"location":"examples/array-assertions/#resourcesyaml","title":"<code>resources.yaml</code>","text":"<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  containers:\n  - name: container-1\n    image: nginx-1\n    env:\n    - name: ENV_1\n      value: value-1\n  - name: container-2\n    image: nginx-2\n    env:\n    - name: ENV_2\n      value: value-2\n  - name: container-3\n    image: nginx-3\n    env:\n    - name: ENV_3\n      value: value-3\n</code></pre>"},{"location":"examples/array-assertions/#assertionsyaml","title":"<code>assertions.yaml</code>","text":"<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: example\nspec:\n  # iterate over all containers having `name: container-1`\n  ~.(containers[?name == 'container-1']):\n    image: nginx-1\n  # iterate over all containers, bind `$index` to the element index\n  ~index.(containers):\n    image: (join('-', ['nginx', to_string($index + `1`)]))\n  # nested iteration\n  ~index2.(containers):\n    ~.(env):\n      name: (join('_', ['ENV', to_string($index2 + `1`)]))\n      value: (join('-', ['value', to_string($index2 + `1`)]))\n</code></pre>"},{"location":"examples/array-assertions/#test","title":"Test","text":""},{"location":"examples/array-assertions/#chainsaw-testyaml","title":"<code>chainsaw-test.yaml</code>","text":"<pre><code># yaml-language-server: $schema=https://raw.githubusercontent.com/kyverno/chainsaw/main/.schemas/json/test-chainsaw-v1alpha1.json\napiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: array-assertions\nspec:\n  steps:\n  - try:\n    - apply:\n        file: resources.yaml\n    - assert:\n        file: assertions.yaml\n</code></pre>"},{"location":"examples/array-assertions/#execute","title":"Execute","text":"<pre><code>chainsaw test\n</code></pre>"},{"location":"examples/assertion-tree/","title":"Assertion trees","text":"<p>Test steps:</p> <ol> <li>Creates a Deployment with 2 replicas</li> <li>Asserts that the number of replicas is &gt; 1 and that <code>status.replicas == spec.replicas</code></li> </ol>"},{"location":"examples/assertion-tree/#setup","title":"Setup","text":"<p>See Setup docs</p>"},{"location":"examples/assertion-tree/#manifests","title":"Manifests","text":""},{"location":"examples/assertion-tree/#resourcesyaml","title":"<code>resources.yaml</code>","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 2\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx\n</code></pre>"},{"location":"examples/assertion-tree/#assertionsyaml","title":"<code>assertions.yaml</code>","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\n(status.replicas == spec.replicas): true\nspec:\n  (replicas &gt; `1`): true\n</code></pre>"},{"location":"examples/assertion-tree/#test","title":"Test","text":""},{"location":"examples/assertion-tree/#chainsaw-testyaml","title":"<code>chainsaw-test.yaml</code>","text":"<pre><code># yaml-language-server: $schema=https://raw.githubusercontent.com/kyverno/chainsaw/main/.schemas/json/test-chainsaw-v1alpha1.json\napiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: assertion-tree\nspec:\n  steps:\n  - try:\n    - apply:\n        file: resources.yaml\n    - assert:\n        file: assertions.yaml\n</code></pre>"},{"location":"examples/assertion-tree/#execute","title":"Execute","text":"<pre><code>chainsaw test\n</code></pre>"},{"location":"examples/basic/","title":"Basic","text":"<p>Test steps:</p> <ol> <li>Creates a ConfigMap</li> <li>Asserts the ConfigMap contains the expected data</li> </ol>"},{"location":"examples/basic/#setup","title":"Setup","text":"<p>See Setup docs</p>"},{"location":"examples/basic/#manifests","title":"Manifests","text":""},{"location":"examples/basic/#resourcesyaml","title":"<code>resources.yaml</code>","text":"<pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: quick-start\ndata:\n  foo: bar\n</code></pre>"},{"location":"examples/basic/#assertionsyaml","title":"<code>assertions.yaml</code>","text":"<pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: quick-start\ndata:\n  foo: bar\n</code></pre>"},{"location":"examples/basic/#test","title":"Test","text":""},{"location":"examples/basic/#chainsaw-testyaml","title":"<code>chainsaw-test.yaml</code>","text":"<pre><code># yaml-language-server: $schema=https://raw.githubusercontent.com/kyverno/chainsaw/main/.schemas/json/test-chainsaw-v1alpha1.json\napiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: basic\nspec:\n  steps:\n  - try:\n    - apply:\n        file: resources.yaml\n    - assert:\n        file: assertions.yaml\n</code></pre>"},{"location":"examples/basic/#execute","title":"Execute","text":"<pre><code>chainsaw test\n</code></pre>"},{"location":"examples/inline/","title":"Inline resources","text":"<p>Test steps:</p> <ol> <li>Creates a ConfigMap</li> <li>Asserts the ConfigMap contains the expected data</li> </ol>"},{"location":"examples/inline/#setup","title":"Setup","text":"<p>See Setup docs</p>"},{"location":"examples/inline/#test","title":"Test","text":""},{"location":"examples/inline/#chainsaw-testyaml","title":"<code>chainsaw-test.yaml</code>","text":"<pre><code># yaml-language-server: $schema=https://raw.githubusercontent.com/kyverno/chainsaw/main/.schemas/json/test-chainsaw-v1alpha1.json\napiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: inline-resources\nspec:\n  steps:\n  - try:\n    - apply:\n        resource:\n          apiVersion: v1\n          kind: ConfigMap\n          metadata:\n            name: quick-start\n          data:\n            foo: bar\n    - assert:\n        resource:\n          apiVersion: v1\n          kind: ConfigMap\n          metadata:\n            name: quick-start\n          data:\n            foo: bar\n</code></pre>"},{"location":"examples/inline/#execute","title":"Execute","text":"<pre><code>chainsaw test\n</code></pre>"},{"location":"examples/labels-selector/","title":"Labels selector","text":"<p>Test steps:</p> <ol> <li>Creates a ConfigMap</li> <li>Asserts the ConfigMap contains the expected data</li> </ol> <p>This test is similar to the basic example but Chainsaw is invoked with the <code>--selector</code> flag.</p>"},{"location":"examples/labels-selector/#setup","title":"Setup","text":"<p>See Setup docs</p>"},{"location":"examples/labels-selector/#manifests","title":"Manifests","text":""},{"location":"examples/labels-selector/#resourcesyaml","title":"<code>resources.yaml</code>","text":"<pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: quick-start\ndata:\n  foo: bar\n</code></pre>"},{"location":"examples/labels-selector/#assertionsyaml","title":"<code>assertions.yaml</code>","text":"<pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: quick-start\ndata:\n  foo: bar\n</code></pre>"},{"location":"examples/labels-selector/#test","title":"Test","text":""},{"location":"examples/labels-selector/#chainsaw-testyaml","title":"<code>chainsaw-test.yaml</code>","text":"<pre><code># yaml-language-server: $schema=https://raw.githubusercontent.com/kyverno/chainsaw/main/.schemas/json/test-chainsaw-v1alpha1.json\napiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: labels-selector\n  labels:\n    # test labels\n    test-suite: examples\nspec:\n  steps:\n  - try:\n    - apply:\n        file: resources.yaml\n    - assert:\n        file: assertions.yaml\n</code></pre>"},{"location":"examples/labels-selector/#execute","title":"Execute","text":"<pre><code># invoke chainsaw with `--selector` to filter tests to run\nchainsaw test --selector test-suite=examples\n</code></pre>"},{"location":"examples/non-resource-assertion/","title":"Non resource assertion","text":"<p>This test example demonstrates how to perform assertions not based on resources.</p> <ol> <li>Asserts that the number of nodes in the cluster is equal to 1</li> </ol>"},{"location":"examples/non-resource-assertion/#setup","title":"Setup","text":"<p>See Setup docs</p>"},{"location":"examples/non-resource-assertion/#manifests","title":"Manifests","text":""},{"location":"examples/non-resource-assertion/#assertionsyaml","title":"<code>assertions.yaml</code>","text":"<pre><code>(length(x_k8s_list($client, 'v1', 'Node'))): 1\n</code></pre>"},{"location":"examples/non-resource-assertion/#test","title":"Test","text":""},{"location":"examples/non-resource-assertion/#chainsaw-testyaml","title":"<code>chainsaw-test.yaml</code>","text":"<pre><code># yaml-language-server: $schema=https://raw.githubusercontent.com/kyverno/chainsaw/main/.schemas/json/test-chainsaw-v1alpha1.json\napiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: non-resource-assertion\nspec:\n  steps:\n  - try:\n    - assert:\n        file: assertions.yaml\n</code></pre>"},{"location":"examples/non-resource-assertion/#execute","title":"Execute","text":"<pre><code>chainsaw test\n</code></pre>"},{"location":"examples/test-output/","title":"Testing command output","text":"<p>Chainsaw can be used to easily check terminal output from CLIs and other commands. This is useful in that convoluted bash scripts involving chaining together tools like <code>grep</code> can be avoided or at least minimized to only complex use cases. Output to both stdout and stderr can be checked for a given string or precise contents.</p>"},{"location":"examples/test-output/#checking-output-contains","title":"Checking Output Contains","text":"<p>One basic use case for content checking is that the output simply contains a given string or piece of content. For example, you might want to run automated tests on a CLI binary you build to ensure that a given command produces output that contains some content you specify somewhere in the output. Let's use the following output from the <code>kubectl version</code> command to show these examples.</p> <pre><code>kubectl version\n\nClient Version: v1.28.2\nKustomize Version: v5.0.4-0.20230601165947-6ce0bf390ce3\nServer Version: v1.27.4+k3s1\n</code></pre> <p>Below is an example that ensures the string '1.28' is found somewhere in that output. So long as the content is present anywhere, the test will succeed. To perform this check, the <code>contains()</code> JMESPath filter is used.</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: test\nspec:\n  steps:\n  - name: Check kubectl\n    try:\n    - script:\n        content: kubectl version\n        check:\n          # This check ensures that the string '1.28' is found\n          # in stdout or else fails\n          (contains($stdout, '1.28')): true\n</code></pre> <p>Checks for content containing a given value can be negated as well. For example, checking to ensure the output does NOT contain the string '1.25'.</p> <pre><code>- script:\n    content: kubectl version\n    check:\n      # This check ensures that the string '1.25' is NOT found\n      # in stdout or else fails\n      (contains($stdout, '1.25')): false\n</code></pre>"},{"location":"examples/test-output/#checking-output-is-exactly","title":"Checking Output Is Exactly","text":"<p>In addition to checking that CLI/command output contains some contents, you may need to ensure that the contents are exactly as intended. The Chainsaw test below accomplishes this by comparing the entire contents of stdout with those specified in the block scalar. If so much as one character, space, or line break is off, the test will fail. This is useful in that not only can content be checked but the formatting of that content can be ensured it matches a given declaration.</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: test\nspec:\n  steps:\n  - name: Check kubectl\n    try:\n    - script:\n        content: kubectl version\n        check:\n          # This check ensures the contents of stdout are exactly as shown.\n          # Any deviations will cause a failure.\n          ($stdout): |-\n            Client Version: v1.28.2\n            Kustomize Version: v5.0.4-0.20230601165947-6ce0bf390ce3\n            Server Version: v1.27.4+k3s1\n</code></pre>"},{"location":"examples/test-output/#checking-output-in-errors","title":"Checking Output In Errors","text":"<p>In addition to testing that commands succeed and with output in a given shape, it's equally valuable and necessary to perform negative tests; that tests fail and with contents that are as expected. Similarly, those checks can be for output which has some contents as well as output which appears exactly as desired. For example, you may wish to check that running the <code>kubectl foo</code> command not only fails as expected but that the output shown to users contains a certain word or sentence.</p> <pre><code>kubectl foo\n\nerror: unknown command \"foo\" for \"kubectl\"\n\nDid you mean this?\n        top\n</code></pre> <p>Below you can see an example where the command <code>kubectl foo</code> is expected to fail but that the error message returned contains some output, in this case the string 'top'.</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: test\nspec:\n  steps:\n  - name: Check bad kubectl command\n    try:\n    - script:\n        content: kubectl foo\n        check:\n          # This checks that the result of the content was an error.\n          ($error != null): true\n          # This check below ensures that the string 'top' is found in stderr or else fails\n          (contains($stderr, 'top')): true\n</code></pre> <p>Likewise, this failure output can be checked that it is precise. Note that in the example below, due to the use of a tab character in the output of <code>kubectl foo</code>, the value of the <code>($stderr)</code> field is given as a string to preserve these non-printing characters.</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: test\nspec:\n  steps:\n  - name: Check kubectl\n    try:\n    - script:\n        content: kubectl foo\n        check:\n          # This checks that the result of the content was an error.\n          ($error != null): true\n          # This checks that the output is exactly as intended.\n          ($stderr): \"error: unknown command \\\"foo\\\" for \\\"kubectl\\\"\\n\\nDid you mean this?\\n\\ttop\"\n</code></pre>"},{"location":"jp/functions/","title":"Functions","text":"<p>Experimental functions</p> <p>Experimental functions are denoted by the <code>x_</code> prefix.</p> <p>These are functions that are subject to signature change in a future version.</p>"},{"location":"jp/functions/#built-in-functions","title":"built-in functions","text":"Name Signature abs <code>abs(number)</code> avg <code>avg(array[number])</code> ceil <code>ceil(number)</code> contains <code>contains(array|string, any)</code> ends_with <code>ends_with(string, string)</code> find_first <code>find_first(string, string, number, number)</code> find_last <code>find_last(string, string, number, number)</code> floor <code>floor(number)</code> from_items <code>from_items(array[array])</code> group_by <code>group_by(array, expref)</code> items <code>items(object)</code> join <code>join(string, array[string])</code> keys <code>keys(object)</code> length <code>length(string|array|object)</code> lower <code>lower(string)</code> map <code>map(expref, array)</code> max <code>max(array[number]|array[string])</code> max_by <code>max_by(array, expref)</code> merge <code>merge(object)</code> min <code>min(array[number]|array[string])</code> min_by <code>min_by(array, expref)</code> not_null <code>not_null(any)</code> pad_left <code>pad_left(string, number, string)</code> pad_right <code>pad_right(string, number, string)</code> replace <code>replace(string, string, string, number)</code> reverse <code>reverse(array|string)</code> sort <code>sort(array[string]|array[number])</code> sort_by <code>sort_by(array, expref)</code> split <code>split(string, string, number)</code> starts_with <code>starts_with(string, string)</code> sum <code>sum(array[number])</code> to_array <code>to_array(any)</code> to_number <code>to_number(any)</code> to_string <code>to_string(any)</code> trim <code>trim(string, string)</code> trim_left <code>trim_left(string, string)</code> trim_right <code>trim_right(string, string)</code> type <code>type(any)</code> upper <code>upper(string)</code> values <code>values(object)</code> zip <code>zip(array, array)</code>"},{"location":"jp/functions/#kyverno-json-functions","title":"kyverno-json functions","text":"Name Signature at <code>at(array, any)</code> concat <code>concat(string, string)</code> json_parse <code>json_parse(string)</code> wildcard <code>wildcard(string, string)</code>"},{"location":"jp/functions/#kyverno-functions","title":"kyverno functions","text":"Name Signature compare <code>compare(string, string)</code> equal_fold <code>equal_fold(string, string)</code> replace <code>replace(string, string, string, number)</code> replace_all <code>replace_all(string, string, string)</code> to_upper <code>to_upper(string)</code> to_lower <code>to_lower(string)</code> trim <code>trim(string, string)</code> trim_prefix <code>trim_prefix(string, string)</code> split <code>split(string, string)</code> regex_replace_all <code>regex_replace_all(string, string|number, string|number)</code> regex_replace_all_literal <code>regex_replace_all_literal(string, string|number, string|number)</code> regex_match <code>regex_match(string, string|number)</code> pattern_match <code>pattern_match(string, string|number)</code> label_match <code>label_match(object, object)</code> to_boolean <code>to_boolean(string)</code> add <code>add(any, any)</code> sum <code>sum(array)</code> subtract <code>subtract(any, any)</code> multiply <code>multiply(any, any)</code> divide <code>divide(any, any)</code> modulo <code>modulo(any, any)</code> round <code>round(number, number)</code> base64_decode <code>base64_decode(string)</code> base64_encode <code>base64_encode(string)</code> time_since <code>time_since(string, string, string)</code> time_now <code>time_now()</code> time_now_utc <code>time_now_utc()</code> path_canonicalize <code>path_canonicalize(string)</code> truncate <code>truncate(string, number)</code> semver_compare <code>semver_compare(string, string)</code> parse_json <code>parse_json(string)</code> parse_yaml <code>parse_yaml(string)</code> lookup <code>lookup(object|array, string|number)</code> items <code>items(object|array, string, string)</code> object_from_lists <code>object_from_lists(array, array)</code> random <code>random(string)</code> x509_decode <code>x509_decode(string)</code> time_to_cron <code>time_to_cron(string)</code> time_add <code>time_add(string, string)</code> time_parse <code>time_parse(string, string)</code> time_utc <code>time_utc(string)</code> time_diff <code>time_diff(string, string)</code> time_before <code>time_before(string, string)</code> time_after <code>time_after(string, string)</code> time_between <code>time_between(string, string, string)</code> time_truncate <code>time_truncate(string, string)</code>"},{"location":"jp/functions/#chainsaw-functions","title":"chainsaw functions","text":"Name Signature env <code>env(string)</code> x_k8s_get <code>x_k8s_get(any, string, string, string, string)</code> x_k8s_list <code>x_k8s_list(any, string, string, string)</code> x_k8s_exists <code>x_k8s_exists(any, string, string, string, string)</code> x_k8s_resource_exists <code>x_k8s_resource_exists(any, string, string)</code>"},{"location":"more/crds/","title":"Working with CRDs","text":"<p>New Custom Resource Definitions are not immediately available for use in the Kubernetes API until the Kubernetes API has acknowledged them.</p> <p>If a Custom Resource Definition is being defined inside of a test step, be sure to wait for the CustomResourceDefinition object to appear.</p> <p>For example, given this Custom Resource Definition:</p> <pre><code>apiVersion: apiextensions.k8s.io/v1beta1\nkind: CustomResourceDefinition\nmetadata:\n  name: mycrds.mycrd.k8s.io\nspec:\n  group: mycrd.k8s.io\n  version: v1alpha1\n  names:\n    kind: MyCRD\n    listKind: MyCRDList\n    plural: mycrds\n    singular: mycrd\n  scope: Namespaced\n</code></pre> <p>Create the following assert:</p> <pre><code>apiVersion: apiextensions.k8s.io/v1beta1\nkind: CustomResourceDefinition\nmetadata:\n  name: mycrds.mycrd.k8s.io\nstatus:\n  acceptedNames:\n    kind: MyCRD\n    listKind: MyCRDList\n    plural: mycrds\n    singular: mycrd\n  storedVersions:\n  - v1alpha1\n</code></pre> <p>And then the CRD can be used in subsequent steps:</p> <pre><code>apiVersion: mycrd.k8s.io/v1alpha1\nkind: MyCRD\nmetadata:\n  name: my-crds\nspec:\n  test: test\n</code></pre>"},{"location":"more/events/","title":"Working with events","text":"<p>Kubernetes events are regular Kubernetes objects and can be asserted on just like any other object:</p> <pre><code>apiVersion: v1\nkind: Event\nreason: Started\nsource:\n  component: kubelet\ninvolvedObject:\n  apiVersion: v1\n  kind: Pod\n  name: my-pod\n</code></pre>"},{"location":"more/kuttl-migration/","title":"Migration from KUTTL","text":""},{"location":"more/kuttl-migration/#overview","title":"Overview","text":"<p>The <code>chainsaw migrate kuttl tests</code> and <code>chainsaw migrate kuttl config</code> commands are designed for the migration of KUTTL tests to Chainsaw.</p> <ul> <li> <p><code>chainsaw migrate kuttl config</code></p> <p>migrates a KUTTL <code>TestSuite</code> to the corresponding Chainsaw <code>Configuration</code></p> </li> <li> <p><code>chainsaw migrate kuttl tests</code></p> <p>migrates KUTTL tests to the corresponding Chainsaw <code>Test</code>s</p> </li> </ul> <p>Reference documentation</p> <p>You can view the full command documentation here.</p>"},{"location":"more/kuttl-migration/#examples","title":"Examples","text":""},{"location":"more/kuttl-migration/#migrate-tests","title":"Migrate tests","text":"<p>The command below will migrate KUTTL tests to Chainsaw and overwrite original files with converted ones.</p> <pre><code>chainsaw migrate kuttl tests path/to/kuttl/tests --save --cleanup\n</code></pre> <p>This will generate a <code>chainsaw-test.yaml</code> for every KUTTL test discovered.</p>"},{"location":"more/kuttl-migration/#migrate-configuration","title":"Migrate configuration","text":"<p>The command below will migrate a KUTTL test suite file to the corresponding Chainsaw <code>Configuration</code>.</p> <pre><code>chainsaw migrate kuttl config path/to/kuttl/testsuite --save --cleanup\n</code></pre> <p>This will generate a <code>.chainsaw.yaml</code> configuration file.</p>"},{"location":"more/lint/","title":"Lint tests","text":""},{"location":"more/lint/#overview","title":"Overview","text":"<p>Chainsaw comes with a <code>lint</code> command to detect ill-formated tests.</p> <p>Reference documentation</p> <p>You can view the full command documentation here.</p>"},{"location":"more/lint/#usage","title":"Usage","text":"<p>To build the docs of a test, Chainsaw provides the <code>chainsaw lint test -f path/to/chainsaw-test.yaml</code> command.</p> <pre><code>chainsaw lint test -f - &lt;&lt;EOF\napiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: assertion-tree\nspec:\n  steps:\n  - try:\n    - assert:\n        file: assert.yaml\nEOF\n</code></pre> <pre><code>Processing input...\nThe document is valid\n</code></pre>"},{"location":"more/test-docs/","title":"Building test docs","text":""},{"location":"more/test-docs/#overview","title":"Overview","text":"<p>Chainsaw makes it simple to build the documentation of your tests.</p> <p>As test suites grow, it becomes important to document what a test does and how it is supposed to work.</p> <p>Going through the implementation of a test to understand its purpose is not an efficient strategy.</p> <p>Reference documentation</p> <p>You can view the full command documentation here.</p>"},{"location":"more/test-docs/#usage","title":"Usage","text":"<p>To build the docs of a test, Chainsaw provides the <code>chainsaw build docs</code> command.</p> <pre><code>chainsaw build docs --test-dir path/to/chainsaw/tests\n</code></pre> <p>This will automatically discover tests and document steps and operations in <code>try</code>, <code>catch</code> and <code>finally</code> statements.</p>"},{"location":"more/test-docs/#the-description-field","title":"The <code>description</code> field","text":"<p>Additionally, you can set the <code>description</code> field in:</p> <ul> <li><code>TestSpec</code></li> <li><code>TestStepSpec</code></li> <li><code>Operation</code></li> <li><code>Catch</code></li> <li><code>Finally</code></li> </ul> <p>Chainsaw will output them nicely in the built docs.</p>"},{"location":"more/test-docs/#example","title":"Example","text":"<p>See below for an example test and the corresponding built docs.</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: basic\nspec:\n  description: This is a very simple test that creates a configmap and checks the content is as expected.\n  steps:\n  - description: This steps applies the configmap in the cluster and checks the configmap content.\n    try:\n    - description: Create the configmap.\n      apply:\n        file: configmap.yaml\n    - description: Check the configmap content.\n      assert:\n        file: configmap-assert.yaml\n</code></pre>"},{"location":"more/test-docs/#test-basic","title":"Test: <code>basic</code>","text":"<p>This is a very simple test that creates a configmap and checks the content is as expected.</p>"},{"location":"more/test-docs/#steps","title":"Steps","text":"# Name Try Catch Finally 1 step-1 2 0 0"},{"location":"more/test-docs/#step-step-1","title":"Step: <code>step-1</code>","text":"<p>This step applies the configmap in the cluster and checks the configmap content.</p>"},{"location":"more/test-docs/#try","title":"Try","text":"# Operation Description 1 <code>apply</code> Create the configmap. 2 <code>assert</code> Check the configmap content."},{"location":"operations/","title":"Operations","text":"<p>While tests are made of test steps, test steps can be considered made of operations.</p> <p>Every operation in a test step runs sequentially.</p> <p>Only one action per operation</p> <p>Every operation consists of a single action. While it is syntactically possible to create an operation with multiple actions, Chainsaw will verify and reject tests if operations containing multiple actions are found.</p> <p>The reasoning behind this intentional choice is that it becomes harder to understand in which order actions will be executed in case an operation consists of multiple actions. For this reason, operations consisting of multiple actions are disallowed.</p>"},{"location":"operations/#common-fields","title":"Common fields","text":"<p>All operations share some configuration fields.</p> <p>Reference documentation</p> <p>The full structure of the <code>Operation</code> is documented here.</p>"},{"location":"operations/#continueonerror","title":"ContinueOnError","text":"<p>Determines whether a test step should continue or not in case the operation is not successful.</p> <p>Even if the test continues executing, it will still be reported as failed.</p>"},{"location":"operations/#available-operations","title":"Available operations","text":"<ul> <li>Apply</li> <li>Assert</li> <li>Command</li> <li>Create</li> <li>Delete</li> <li>Error</li> <li>Patch</li> <li>Script</li> <li>Sleep</li> <li>Wait</li> </ul>"},{"location":"operations/#non-resource-assertions","title":"Non-resource assertions","text":"<p>It is possible to evaluate assertions that do not depend on resources.</p> <p>See Non-resource assertions for details.</p>"},{"location":"operations/#operation-checks","title":"Operation checks","text":"<p>Some operations support checking the operation execution result against specific expectations.</p> <p>See Operation checks for use case details and supported operations.</p>"},{"location":"operations/#resource-templating","title":"Resource templating","text":"<p>Chainsaw can apply transformations to the resources before they are processed by the operation.</p> <p>See Resource templating for use case details and supported operations.</p>"},{"location":"operations/apply/","title":"Apply","text":"<p>The <code>apply</code> operation lets you define resources that should be applied to the Kubernetes cluster during the test step.</p> <p>These can be configurations, deployments, services, or any other Kubernetes resource.</p> <p>Reference documentation</p> <ul> <li>The full structure of the <code>Apply</code> is documented here.</li> <li>This operation supports bindings.</li> </ul>"},{"location":"operations/apply/#usage-in-test","title":"Usage in <code>Test</code>","text":"<p>Below is an example of using <code>apply</code> in a <code>Test</code> resource.</p> <p>Using a specific file</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - apply:\n        file: my-configmap.yaml\n    # ...\n</code></pre> <p>Using file path expressions</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example-multi\nspec:\n  steps:\n  - try:\n    # ...\n    - apply:\n        file: \"configs/*.yaml\"\n    # ...\n</code></pre> <p>Using an URL</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - apply:\n        file: https://raw.githubusercontent.com/kyverno/chainsaw/main/testdata/step/configmap.yaml\n    # ...\n</code></pre> <p>Using an inline resource</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - apply:\n        resource:\n          apiVersion: v1\n          kind: ConfigMap\n          metadata:\n            name: chainsaw-quick-start\n          data:\n            foo: bar\n    # ...\n</code></pre>"},{"location":"operations/apply/#operation-check","title":"Operation check","text":"<p>Below is an example of using an operation check.</p> <p>With check</p> <pre><code># ...\n- apply:\n    file: my-configmap.yaml\n    expect:\n    - match:\n        # this check applies only if the match\n        # statement below evaluates to `true`\n        apiVersion: v1\n        kind: ConfigMap\n      check:\n        # an error is expected, this will:\n        # - succeed if the operation failed\n        # - fail if the operation succeeded\n        ($error != null): true\n# ...\n</code></pre> <p>With check</p> <pre><code># ...\n- apply:\n    resource:\n      apiVersion: v1\n      kind: ConfigMap\n      metadata:\n        name: chainsaw-quick-start\n      data:\n        foo: bar\n    expect:\n    - match:\n        # this check applies only if the match\n        # statement below evaluates to `true`\n        apiVersion: v1\n        kind: ConfigMap\n      check:\n        # an error is expected, this will:\n        # - succeed if the operation failed\n        # - fail if the operation succeeded\n        ($error != null): true\n# ...\n</code></pre>"},{"location":"operations/assert/","title":"Assert","text":"<p>The <code>assert</code> operation allows you to specify conditions that should hold true for a successful test.</p> <p>For example, after applying resources, you might want to ensure that a particular pod is running or a service is accessible.</p> <p>Assertion trees</p> <p>Assertions in Chainsaw are based on assertion trees.</p> <p>Assertion trees are a solution to declaratively represent complex conditions like partial array comparisons or complex operations against an incoming data structure.</p> <p>Assertion trees are compatible with standard assertions that exist in tools like KUTTL but can do a lot more. Please see the assertion trees documentation in kyverno-json for details.</p> <p>Reference documentation</p> <ul> <li>The full structure of the <code>Assert</code> is documented here.</li> <li>This operation supports bindings.</li> </ul>"},{"location":"operations/assert/#usage-in-test","title":"Usage in <code>Test</code>","text":"<p>Below is an example of using <code>assert</code> in a <code>Test</code> resource.</p> <p>Using a specific file for assertions</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - assert:\n        file: ../resources/deployment-assert.yaml\n    # ...\n</code></pre> <p>Using file path expressions for assertions</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example-multi\nspec:\n  steps:\n  - try:\n    # ...\n    - assert:\n        file: \"../assertions/*.yaml\"\n    # ...\n</code></pre> <p>Using an URL</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - assert:\n        file: https://raw.githubusercontent.com/kyverno/chainsaw/main/testdata/resource/valid.yaml\n    # ...\n</code></pre> <p>Using an inline assertion tree</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - assert:\n        resource:\n          apiVersion: v1\n          kind: Deployment\n          metadata:\n            name: foo\n          spec:\n            (replicas &gt; 3): true\n    # ...\n</code></pre>"},{"location":"operations/check/","title":"Operation checks","text":"<p>Considering an operation success or failure is not always as simple as checking an error code.</p> <ul> <li>Sometimes an operation can fail but the failure is what you expected, hence the operation should be reported as successful.</li> <li>Sometimes an operation can succeed but the result is not what you expected, in this case the operation should be reported as a failure.</li> </ul> <p>To support those kinds of use cases, some operations support an additional <code>check</code> field to evaluate the operation result against an assertion tree.</p> <p>Assertion trees</p> <p>Assertions in Chainsaw are based on assertion trees.</p> <p>Assertion trees are a solution to declaratively represent complex conditions like partial array comparisons or complex operations against an incoming data structure.</p> <p>Assertion trees are compatible with standard assertions that exist in tools like KUTTL but can do a lot more. Please see the assertion trees documentation in kyverno-json for details.</p> <p>Checked model</p> <p>Different operations have a different model passed through the assertion tree.</p> <p>The object passed to the assertion tree is the output object of the operation. Additional data like error or standard logs are passed using bindings (<code>$error</code>, <code>$stdout</code>, <code>$stderr</code>)</p>"},{"location":"operations/check/#expect-vs-check","title":"<code>Expect</code> vs <code>Check</code>","text":"<p>While a simple check is enough to determine the result of a single operation, we needed a more advanced construct to cover <code>apply</code> and <code>create</code> operations. Those operations can operate on files containing multiple manifests and every manifest can have a different result.</p> <p>To support more granular checks we use the <code>expect</code> field that contains an array of Expectations. Every expectation is made of an optional <code>match</code> and a <code>check</code> statement.</p> <p>This way it is possible to control the scope of a <code>check</code>.</p> <p>Null match</p> <p>If the <code>match</code> statement is null, the <code>check</code> statement applies to all manifests in the operation.</p> <p>If no expectation matches a given manifest, the default expectation will be used, checking that no error occurred.</p>"},{"location":"operations/check/#apply","title":"Apply","text":"<p><code>apply</code> supports <code>expect</code> and has the following elements to be checked:</p> Name Purpose Type <code>$values</code> Values provided when invoking chainsaw with <code>--values</code> flag <code>object</code> <code>$namespace</code> Name of the current test namespace <code>string</code> <code>$client</code> Kubernetes client chainsaw is connected to (if not running with <code>--no-cluster</code>) <code>object</code> <code>$error</code> The error message (if any) at the end of the operation <code>string</code> <code>@</code> The state of the resource (if any) at the end of the operation <code>object</code>"},{"location":"operations/check/#command","title":"Command","text":"<p><code>command</code> supports <code>check</code> and has the following elements to be checked:</p> Name Purpose Type <code>$values</code> Values provided when invoking chainsaw with <code>--values</code> flag <code>object</code> <code>$namespace</code> Name of the current test namespace <code>string</code> <code>$client</code> Kubernetes client chainsaw is connected to (if not running with <code>--no-cluster</code>) <code>object</code> <code>$error</code> The error message (if any) at the end of the operation <code>string</code> <code>$stdout</code> The content of the standard console output (if any) at the end of the operation <code>string</code> <code>$stderr</code> The content of the standard console error output (if any) at the end of the operation <code>string</code> <code>@</code> Always <code>null</code>"},{"location":"operations/check/#create","title":"Create","text":"<p><code>create</code> supports <code>expect</code> and has the following elements to be checked:</p> Name Purpose Type <code>$values</code> Values provided when invoking chainsaw with <code>--values</code> flag <code>object</code> <code>$namespace</code> Name of the current test namespace <code>string</code> <code>$client</code> Kubernetes client chainsaw is connected to (if not running with <code>--no-cluster</code>) <code>object</code> <code>$error</code> The error message (if any) at the end of the operation <code>string</code> <code>@</code> The state of the resource (if any) at the end of the operation <code>object</code>"},{"location":"operations/check/#delete","title":"Delete","text":"<p><code>delete</code> supports <code>check</code> and has the following elements to be checked:</p> Name Purpose Type <code>$values</code> Values provided when invoking chainsaw with <code>--values</code> flag <code>object</code> <code>$namespace</code> Name of the current test namespace <code>string</code> <code>$client</code> Kubernetes client chainsaw is connected to (if not running with <code>--no-cluster</code>) <code>object</code> <code>$error</code> The error message (if any) at the end of the operation <code>string</code> <code>@</code> The state of the resource (if any) at the end of the operation <code>object</code>"},{"location":"operations/check/#patch","title":"Patch","text":"<p><code>patch</code> supports <code>expect</code> and has the following elements to be checked:</p> Name Purpose Type <code>$values</code> Values provided when invoking chainsaw with <code>--values</code> flag <code>object</code> <code>$namespace</code> Name of the current test namespace <code>string</code> <code>$client</code> Kubernetes client chainsaw is connected to (if not running with <code>--no-cluster</code>) <code>object</code> <code>$error</code> The error message (if any) at the end of the operation <code>string</code> <code>@</code> The state of the resource (if any) at the end of the operation <code>object</code>"},{"location":"operations/check/#script","title":"Script","text":"<p><code>script</code> supports <code>check</code> and has the following elements to be checked:</p> Name Purpose Type <code>$values</code> Values provided when invoking chainsaw with <code>--values</code> flag <code>object</code> <code>$namespace</code> Name of the current test namespace <code>string</code> <code>$client</code> Kubernetes client chainsaw is connected to (if not running with <code>--no-cluster</code>) <code>object</code> <code>$error</code> The error message (if any) at the end of the operation <code>string</code> <code>$stdout</code> The content of the standard console output (if any) at the end of the operation <code>string</code> <code>$stderr</code> The content of the standard console error output (if any) at the end of the operation <code>string</code> <code>@</code> Always <code>null</code>"},{"location":"operations/command/","title":"Command","text":"<p>The <code>command</code> operation provides a means to execute a specific command during the test step.</p> <p>Reference documentation</p> <ul> <li>The full structure of the <code>Command</code> is documented here.</li> <li>This operation supports bindings.</li> </ul>"},{"location":"operations/command/#usage-in-test","title":"Usage in <code>Test</code>","text":"<p>Below is an example of using <code>command</code> in a <code>Test</code> resource.</p> <p>Example</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - command:\n        entrypoint: echo\n        args:\n        - hello chainsaw\n    # ...\n</code></pre>"},{"location":"operations/command/#operation-check","title":"Operation check","text":"<p>Below is an example of using an operation check.</p> <p>With check</p> <pre><code># ...\n- command:\n    entrypoint: echo\n    args:\n    - hello chainsaw\n    check:\n      # an error is expected, this will:\n      # - succeed if the operation failed\n      # - fail if the operation succeeded\n      ($error != null): true\n# ...\n</code></pre>"},{"location":"operations/create/","title":"Create","text":"<p>The <code>create</code> operation lets you define resources that should be created in the Kubernetes cluster during the test step. These can be configurations, deployments, services, or any other Kubernetes resource.</p> <p>Warning</p> <p>If the resource to be created already exists in the cluster, the step will fail.</p> <p>Reference documentation</p> <ul> <li>The full structure of the <code>Create</code> is documented here.</li> <li>This operation supports bindings.</li> </ul>"},{"location":"operations/create/#usage-in-test","title":"Usage in <code>Test</code>","text":"<p>Below is an example of using <code>create</code> in a <code>Test</code> resource.</p> <p>Using a specific file</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - create:\n        file: my-configmap.yaml\n    # ...\n</code></pre> <p>Using file path expressions</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example-multi\nspec:\n  steps:\n  - try:\n    # ...\n    - create:\n        file: \"configs/*.yaml\"\n    # ...\n</code></pre> <p>Using an URL</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - create:\n        file: https://raw.githubusercontent.com/kyverno/chainsaw/main/testdata/resource/valid.yaml\n    # ...\n</code></pre> <p>Using an inline resource</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - create:\n        resource:\n          apiVersion: v1\n          kind: ConfigMap\n          metadata:\n            name: chainsaw-quick-start\n          data:\n            foo: bar\n    # ...\n</code></pre>"},{"location":"operations/create/#operation-check","title":"Operation check","text":"<p>Below is an example of using an operation check.</p> <p>With check</p> <pre><code># ...\n- create:\n    file: my-configmap.yaml\n    expect:\n    - match:\n        # this check applies only if the match\n        # statement below evaluates to `true`\n        apiVersion: v1\n        kind: ConfigMap\n      check:\n        # an error is expected, this will:\n        # - succeed if the operation failed\n        # - fail if the operation succeeded\n        ($error != null): true\n# ...\n</code></pre> <p>With check</p> <pre><code># ...\n- create:\n    resource:\n      apiVersion: v1\n      kind: ConfigMap\n      metadata:\n        name: chainsaw-quick-start\n      data:\n        foo: bar\n    expect:\n    - match:\n        # this check applies only if the match\n        # statement below evaluates to `true`\n        apiVersion: v1\n        kind: ConfigMap\n      check:\n        # an error is expected, this will:\n        # - succeed if the operation failed\n        # - fail if the operation succeeded\n        ($error != null): true\n# ...\n</code></pre>"},{"location":"operations/delete/","title":"Delete","text":"<p>The <code>delete</code> operation allows you to specify resources that should be deleted from the Kubernetes cluster before a particular test step is executed.</p> <p>Reference documentation</p> <ul> <li>The full structure of the <code>Delete</code> is documented here.</li> <li>This operation supports bindings.</li> </ul>"},{"location":"operations/delete/#usage-in-test","title":"Usage in <code>Test</code>","text":"<p>Below is an example of using <code>delete</code> in a <code>Test</code> resource.</p> <p>Example</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - delete:\n        ref:\n          apiVersion: v1\n          kind: Pod\n          namespace: default\n          name: my-test-pod\n    # ...\n</code></pre>"},{"location":"operations/delete/#operation-check","title":"Operation check","text":"<p>Below is an example of using an operation check.</p> <p>With check</p> <pre><code># ...\n- delete:\n    ref:\n      apiVersion: v1\n      kind: Pod\n      namespace: default\n      name: my-test-pod\n    expect:\n    - match:\n        # this check applies only if the match\n        # statement below evaluates to `true`\n        apiVersion: v1\n        kind: Pod\n        metadata:\n          namespace: default\n          name: my-test-pod\n      check:\n        # an error is expected, this will:\n        # - succeed if the operation failed\n        # - fail if the operation succeeded\n        ($error != null): true\n# ...\n</code></pre>"},{"location":"operations/error/","title":"Error","text":"<p>The <code>error</code> operation lets you define a set of expected errors for a test step. If any of these errors occur during the test, they are treated as expected outcomes. However, if an error that's not on this list occurs, it will be treated as a test failure.</p> <p>Assertion trees</p> <p>Errors in Chainsaw are based on assertion trees.</p> <p>Assertion trees is a solution to declaratively represent complex conditions like partial array comparisons or complex operations against an incoming data structure.</p> <p>Assertion trees are compatible with standard assertions that exist in tools like KUTTL but can do a lot more. Please see the assertion trees documentation in kyverno-json for details.</p> <p>Reference documentation</p> <ul> <li>The full structure of the <code>Error</code> is documented here.</li> <li>This operation supports bindings.</li> </ul>"},{"location":"operations/error/#usage-in-test","title":"Usage in <code>Test</code>","text":"<p>Below is an example of using <code>error</code> in a <code>Test</code> resource.</p> <p>Expecting an error from a specific file</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - error:\n        file: ../resources/deployment-error.yaml\n    # ...\n</code></pre> <p>Using file path expressions to expect errors from multiple files</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example-multi\nspec:\n  steps:\n  - try:\n    # ...\n    - error:\n        file: \"../errors/*.yaml\"\n    # ...\n</code></pre> <p>Using an URL</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - error:\n        file: https://raw.githubusercontent.com/user/repo/branch/path/to/deployment-error.yaml\n    # ...\n</code></pre> <p>Using an inline assertion tree</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - error:\n        resource:\n          apiVersion: v1\n          kind: Deployment\n          metadata:\n            name: foo\n          spec:\n            (replicas &gt; 3): true\n    # ...\n</code></pre>"},{"location":"operations/non-resource-assert/","title":"Non-resource assertions","text":"<p>Under certain circumstances, it makes sense to evaluate assertions that do not depend on resources. For example, when asserting the number of nodes in a cluster is equal to a known value.</p>"},{"location":"operations/non-resource-assert/#usage-in-test","title":"Usage in <code>Test</code>","text":"<p>Below is an example of using <code>assert</code> in a <code>Test</code> resource.</p> <p>Using a file</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: non-resource-assertion\nspec:\n  steps:\n  - try:\n    - assert:\n        resource:\n          (x_k8s_list($client, 'v1', 'Node')):\n            (length(@)): 1\n    - error:\n        resource:\n          (x_k8s_list($client, 'v1', 'Node')):\n            (length(@)): 2\n</code></pre>"},{"location":"operations/patch/","title":"Patch","text":"<p>The <code>patch</code> operation lets you define resources that should be modified in the Kubernetes cluster during the test step. These can be configurations, deployments, services, or any other Kubernetes resource.</p> <p>Warning</p> <p>If the resource to be modified does not exist in the cluster, the step will fail.</p> <p>Reference documentation</p> <ul> <li>The full structure of the <code>Patch</code> is documented here.</li> <li>This operation supports bindings.</li> </ul>"},{"location":"operations/patch/#usage-in-test","title":"Usage in <code>Test</code>","text":"<p>Below is an example of using <code>patch</code> in a <code>Test</code> resource.</p> <p>Using a specific file</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - patch:\n        file: my-configmap.yaml\n    # ...\n</code></pre> <p>Using file path expressions</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example-multi\nspec:\n  steps:\n  - try:\n    # ...\n    - patch:\n        file: \"configs/*.yaml\"\n    # ...\n</code></pre> <p>Using an URL</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - patch:\n        file: https://raw.githubusercontent.com/kyverno/chainsaw/main/testdata/resource/valid.yaml\n    # ...\n</code></pre> <p>Using an inline resource</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - patch:\n        resource:\n          apiVersion: v1\n          kind: ConfigMap\n          metadata:\n            name: chainsaw-quick-start\n          data:\n            foo: bar\n    # ...\n</code></pre>"},{"location":"operations/patch/#operation-check","title":"Operation check","text":"<p>Below is an example of using an operation check.</p> <p>With check</p> <pre><code># ...\n- patch:\n    file: my-configmap.yaml\n    expect:\n    - match:\n        # this check applies only if the match\n        # statement below evaluates to `true`\n        apiVersion: v1\n        kind: ConfigMap\n      check:\n        # an error is expected, this will:\n        # - succeed if the operation failed\n        # - fail if the operation succeeded\n        ($error != null): true\n# ...\n</code></pre> <p>With check</p> <pre><code># ...\n- patch:\n    resource:\n      apiVersion: v1\n      kind: ConfigMap\n      metadata:\n        name: chainsaw-quick-start\n      data:\n        foo: bar\n    expect:\n    - match:\n        # this check applies only if the match\n        # statement below evaluates to `true`\n        apiVersion: v1\n        kind: ConfigMap\n      check:\n        # an error is expected, this will:\n        # - succeed if the operation failed\n        # - fail if the operation succeeded\n        ($error != null): true\n# ...\n</code></pre>"},{"location":"operations/script/","title":"Script","text":"<p>The <code>script</code> operation provides a means to run a script during the test step.</p> <p>Reference documentation</p> <ul> <li>The full structure of the <code>Script</code> is documented here.</li> <li>This operation supports bindings.</li> </ul>"},{"location":"operations/script/#usage-in-test","title":"Usage in <code>Test</code>","text":"<p>Below is an example of using <code>script</code> in a <code>Test</code> resource.</p> <p>Example</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - script:\n        content: |\n          echo \"hello chainsaw\"\n    # ...\n</code></pre>"},{"location":"operations/script/#operation-check","title":"Operation check","text":"<p>Below is an example of using an operation check.</p> <p>With check</p> <pre><code># ...\n- script:\n    content: |\n      echo \"hello chainsaw\"\n    check:\n      # an error is expected, this will:\n      # - succeed if the operation failed\n      # - fail if the operation succeeded\n      ($error != null): true\n# ...\n</code></pre>"},{"location":"operations/sleep/","title":"Sleep","text":"<p>The <code>sleep</code> operation provides a means to sleep for a configured duration.</p> <p>Reference documentation</p> <p>The full structure of the <code>Sleep</code> is documented here.</p>"},{"location":"operations/sleep/#usage-in-test","title":"Usage in <code>Test</code>","text":"<p>Below is an example of using <code>sleep</code> in a <code>Test</code> resource.</p> <p>Example</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - sleep:\n        duration: 30s\n    # ...\n</code></pre>"},{"location":"operations/templating/","title":"Resource templating","text":"<p>Experimental status</p> <p>This is an experimental feature, and implementation could change slightly in the next versions.</p> <p>Chainsaw can apply transformations to the resources before they are processed by the operation.</p> <p>This is useful when a resource needs some runtime configuration.</p> <p>Templating must be enabled at the configuration, test, step, or operation level for the templating process to kick in. Alternatively, templating can be enabled using the <code>--template</code> flag when invoking chainsaw from the command line.</p> <p>Note</p> <p>Unlike assertion trees, templating can only be specified in leave nodes of the YAML tree.</p>"},{"location":"operations/templating/#supported-operations","title":"Supported operations","text":"<p>Resource templating is supported in the following operations:</p> <ul> <li>Assert</li> <li>Error</li> <li>Apply</li> <li>Create</li> <li>Delete</li> <li>Patch</li> </ul>"},{"location":"operations/templating/#assert-and-error","title":"Assert and Error","text":"<p>When templating <code>assert</code> or <code>error</code> operations, the content is already an assertion tree.</p> <p>For this reason, only the elements used for looking up the resources to be processed by the operation will be considered for templating. That is, only <code>apiVersion</code>, <code>kind</code>, <code>name</code>, <code>namespace</code> and <code>labels</code> are considered for templating. Other fields are not, they are part of the assertion tree only.</p> <p>assert and error example</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: template\nspec:\n  template: true\n  steps:\n  - assert:\n      resource:\n        # apiVersion, kind, name, namespace and labels are considered for templating\n        apiVersion: v1\n        kind: ConfigMap\n        metadata:\n          name: ($namespace)\n        # other fields are not (they are part of the assertion tree)\n        data:\n          foo: ($namespace)\n  - error:\n      resource:\n        # apiVersion, kind, name, namespace and labels are considered for templating\n        apiVersion: v1\n        kind: ConfigMap\n        metadata:\n          name: ($namespace)\n        # other fields are not (they are part of the assertion tree)\n        data:\n          bar: ($namespace)\n</code></pre>"},{"location":"operations/templating/#apply-create-and-patch","title":"Apply, Create and Patch","text":"<p>When templating <code>apply</code>, <code>create</code> or <code>patch</code> operations, the whole content is considered for templating.</p> <p>apply and create example</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: template\nspec:\n  template: true\n  steps:\n  - apply:\n      resource:\n        # the whole content is considered for templating\n        apiVersion: v1\n        kind: ConfigMap\n        metadata:\n          name: ($namespace)\n        data:\n          foo: ($namespace)\n  - create:\n      resource:\n        # the whole content is considered for templating\n        apiVersion: v1\n        kind: ConfigMap\n        metadata:\n          name: ($namespace)\n        data:\n          foo: ($namespace)\n  - patch:\n      resource:\n        # the whole content is considered for templating\n        apiVersion: v1\n        kind: ConfigMap\n        metadata:\n          name: ($namespace)\n        data:\n          foo: ($namespace)\n</code></pre>"},{"location":"operations/templating/#delete","title":"Delete","text":"<p>When templating <code>delete</code> operations, the whole content is considered for templating.</p> <p>apply and create example</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: template\nspec:\n  template: true\n  steps:\n  - delete:\n      ref:\n        # the whole content is considered for templating\n        apiVersion: v1\n        kind: ConfigMap\n        name: ($namespace)\n</code></pre>"},{"location":"operations/wait/","title":"Wait","text":"<p>The <code>wait</code> is a wrapper around <code>kubectl wait</code>. It allows to wait for deletion or conditions against resources.</p> <p>Reference documentation</p> <p>The full structure of the <code>Wait</code> is documented here.</p>"},{"location":"operations/wait/#usage-in-test","title":"Usage in <code>Test</code>","text":"<p>Below is an example of using <code>wait</code> in a <code>Test</code> resource.</p> <p>Wait pod ready</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - wait:\n        resource: pods\n        name: my-pod\n        timeout: 1m\n        for:\n          condition:\n            name: Ready\n            value: 'true'\n    # ...\n</code></pre> <p>Wait pod ready in a specific namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - wait:\n        resource: pods\n        name: my-pod\n        namespace: my-ns\n        timeout: 1m\n        for:\n          condition:\n            name: Ready\n            value: 'true'\n    # ...\n</code></pre> <p>Wait pods ready using a label selector</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - wait:\n        resource: pods\n        selector: app=foo\n        timeout: 1m\n        for:\n          condition:\n            name: Ready\n            value: 'true'\n    # ...\n</code></pre> <p>Wait pod deleted</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - wait:\n        resource: pods\n        name: my-pod\n        timeout: 1m\n        for:\n          deletion: {}\n    # ...\n</code></pre> <p>Wait pod deleted in a specific namespace</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - wait:\n        resource: pods\n        name: my-pod\n        namespace: my-ns\n        timeout: 1m\n        for:\n          deletion: {}\n    # ...\n</code></pre> <p>Wait pods deleted using a label selector</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - wait:\n        resource: pods\n        selector: app=foo\n        timeout: 1m\n        for:\n          deletion: {}\n    # ...\n</code></pre>"},{"location":"operations/wait/#format","title":"Format","text":"<p>An optional <code>format</code> can be specified. Supported formats are <code>json</code> and <code>yaml</code>.</p> <p>If <code>format</code> is not specified, results will be returned in text format.</p> <p>Use json format</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - wait:\n        resource: pods\n        format: json\n        # ...\n    catch:\n    # ...\n    - wait:\n        resource: pods\n        format: json\n        # ...\n    finally:\n    # ...\n    - wait:\n        resource: pods\n        format: json\n        # ...\n</code></pre> <p>Use yaml format</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    # ...\n    - wait:\n        resource: pods\n        format: yaml\n        # ...\n    catch:\n    # ...\n    - wait:\n        resource: pods\n        format: yaml\n        # ...\n    finally:\n    # ...\n    - wait:\n        resource: pods\n        format: yaml\n        # ...\n</code></pre>"},{"location":"steps/","title":"What is a test step","text":"<p>A test step is made of three main components used to dermine the actions Chainsaw will perform when executing the step.</p> <ol> <li>The try statement (required)</li> <li>The catch statement (optional)</li> <li>The finally statement (optional)</li> </ol> <p>Reference documentation</p> <p>The full structure of the <code>TestStep</code> is documented here.</p>"},{"location":"steps/#test-step-lifecycle","title":"Test step lifecycle","text":"<p>Test step lifecycle</p> <ol> <li>The step starts executing operations in the <code>try</code> statement</li> <li>If an operation fails in the <code>try</code> statement<ol> <li>If a <code>catch</code> statement is present, all operations and collectors are executed</li> </ol> </li> <li>If a <code>finally</code> statement is present, all operations and collectors are executed</li> </ol>"},{"location":"steps/#example","title":"Example","text":"<p>Example</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    - apply:\n        file: path/to/apply.yaml\n    - assert:\n        file: path/to/assert.yaml\n    catch: []\n    finally: []\n</code></pre>"},{"location":"steps/catch/","title":"Catch","text":"<p>A <code>catch</code> statement is also a sequence of operations or collectors.</p> <p>Operations and collectors contained in a <code>catch</code> statement will be executed only if the step failed when executing the operations in the step's try statement.</p> <p>Tip</p> <p>All operations and collectors of a <code>catch</code> statement will be executed regardless of the success or failure of each of them.</p>"},{"location":"steps/catch/#operations","title":"Operations","text":"<p>A <code>catch</code> statement supports only the following operations:</p> <ul> <li>Command</li> <li>Script</li> <li>Sleep</li> <li>Delete</li> <li>Wait</li> </ul>"},{"location":"steps/catch/#collectors","title":"Collectors","text":"<p>A <code>catch</code> statement supports all collectors:</p> <ul> <li>Pod logs</li> <li>Events</li> <li>Get</li> <li>Describe</li> </ul>"},{"location":"steps/catch/#example","title":"Example","text":"<p>Example</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try: []\n    catch:\n    - command:\n        # ...\n    - script:\n        # ...\n    - delete:\n        # ...\n    - events:\n        # ...\n    - podLogs:\n        # ...\n    - describe:\n        # ...\n    - get:\n        # ...\n    - sleep:\n        # ...\n    - wait:\n        # ...\n    finally: []\n</code></pre>"},{"location":"steps/finally/","title":"Finally","text":"<p>A <code>finally</code> statement is similar to a catch statement but will always execute after the try and eventual catch statements finished executing regardless of the success or failure of the test step.</p> <p>Tip</p> <p>All operations and collectors of a <code>finally</code> statement will be executed regardless of the success or failure of each of them.</p>"},{"location":"steps/finally/#operations","title":"Operations","text":"<p>A <code>finally</code> statement supports only the following operations:</p> <ul> <li>Command</li> <li>Script</li> <li>Sleep</li> <li>Delete</li> <li>Wait</li> </ul>"},{"location":"steps/finally/#collectors","title":"Collectors","text":"<p>A <code>finally</code> statement supports all collectors:</p> <ul> <li>Pod logs</li> <li>Events</li> <li>Get</li> <li>Describe</li> </ul>"},{"location":"steps/finally/#example","title":"Example","text":"<p>Example</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try: []\n    catch: []\n    finally:\n    - command:\n        # ...\n    - script:\n        # ...\n    - delete:\n        # ...\n    - events:\n        # ...\n    - podLogs:\n        # ...\n    - describe:\n        # ...\n    - get:\n        # ...\n    - sleep:\n        # ...\n    - wait:\n        # ...\n</code></pre>"},{"location":"steps/try/","title":"Try","text":"<p>A <code>try</code> statement is a sequence of operations executed in the same order they are declared. If an operation fails the entire step is considered failed.</p> <p>The <code>try</code> statement is at the heart of a test step, it represents what the step is supposed to be about.</p> <p>catch and finally statements should be viewed as complementary to the <code>try</code> statement.</p> <p>Continue on error</p> <p>By default, a test step stops executing when an operation fails and the following operations are not executed.</p> <p>This behavior can be changed using the <code>continueOnError</code> field, if <code>continueOnError</code> is set to <code>true</code> the step will still be considered failed but execution will continue with the next operations.</p>"},{"location":"steps/try/#operations","title":"Operations","text":"<p>A <code>try</code> statement supports all operations:</p> <ul> <li>Apply</li> <li>Assert</li> <li>Command</li> <li>Create</li> <li>Delete</li> <li>Error</li> <li>Patch</li> <li>Script</li> <li>Sleep</li> <li>Wait</li> </ul>"},{"location":"steps/try/#example","title":"Example","text":"<p>Example</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: example\nspec:\n  steps:\n  - try:\n    - command:\n        # ...\n    - sleep:\n        # ...\n    - script:\n        # ...\n    - apply:\n        # ...\n    - assert:\n        # ...\n    - error:\n        # ...\n    - create:\n        # ...\n    - patch:\n        # ...\n    - wait:\n        # ...\n    catch: []\n    finally: []\n</code></pre>"},{"location":"tests/","title":"What is a test","text":"<p>To put it simply, a test can be represented as an ordered sequence of test steps.</p> <p>Test steps within a test are run sequentially: if any of the test steps fail, the entire test is considered failed.</p> <p>A test step can consist in one or more operations:</p> <ul> <li>To delete resources present in a cluster</li> <li>To create or update resources in a cluster</li> <li>To assert one or more resources in a cluster meet the expectations (or the opposite)</li> <li>To run arbitrary commands or scripts</li> </ul>"},{"location":"tests/#different-syntaxes","title":"Different syntaxes","text":"<p>Chainsaw supports two different test definition syntaxes. Each syntax has pros and cons, see the descriptions below for more details on advantages and pitfalls.</p>"},{"location":"tests/#manifests-based-syntax","title":"Manifests based syntax","text":"<p>This is the simplest and less verbose syntax.</p> <p>You provide bare Kubernetes resource manifests and Chainsaw will use those manifests to create, update, or assert expectations against a cluster.</p> <p>While this syntax is extremly simple, not all operations are supported. For example, <code>delete</code>, <code>command</code>, <code>script</code> and <code>sleep</code> operations are not.</p> <p>Another strong limitation is that it is not possible to specify additional configuration per test, step or operation.</p> <p>Finally, this syntax relies heavily on file naming conventions, it can be error prone and makes it hard to reuse files across multiple tests.</p>"},{"location":"tests/#test-based-syntax","title":"<code>Test</code> based syntax","text":"<p>The <code>Test</code> based syntax is a more verbose and explicit syntax.</p> <p>It does not rely on file naming conventions to determine test steps order and allows to easily reuse files accross multiple tests.</p> <p>This syntax also comes with no limitations to provide additional configuration at the test, step or operation level.</p> <p>Making a choice</p> <p>Choosing one syntax over the other is not a trivial choice, every one will have its own preference and/or constraints.</p> <p>It's usually easier to start with the manifests based syntax. However, as test suites grow and tests become more complex, it is often necessary to configure options on a per test, step or operation basis and the <code>Test</code> based syntax becomes necessary.</p> <p>Fortunately Chainsaw has a command to automatically migrate from manifest based to <code>Test</code> based syntax.</p>"},{"location":"tests/#namespaced-resources","title":"Namespaced resources","text":"<p>Kubernetes organizes resources into two primary scopes: namespaced and cluster-scoped.</p> <p>While namespaced resources belong to a specific namespace, cluster-scoped resources span across the entire Kubernetes cluster.</p>"},{"location":"tests/#purpose-of-the-namespacer-interface","title":"Purpose of the Namespacer Interface","text":"<p>The Namespacer interface ensures automated and consistent namespace assignment to Kubernetes resources.</p> <ul> <li> <p>Automated Namespacing</p> <p>Automatically assign namespaces to resources that don't have one.</p> </li> <li> <p>Ephemeral Namespaces</p> <p>Handles temporary namespaces for specific tasks.</p> </li> </ul>"},{"location":"tests/#cleanup","title":"Cleanup","text":"<p>Unless configured differently, by default Chainsaw will automatically cleanup the resources it created after a test finishes. Cleanup happens in reverse order of creation (created last, cleaned up first).</p> <p>Note that Chainsaw performs a blocking deletion, that is, it will wait the resource is actually not present anymore in the cluster before proceeding with the next resource cleanup.</p> <p>This is important, especially when the controller being tested makes use of <code>finalizers</code>.</p> <p>Overriding cleanup timeout</p> <p>A global cleanup timeout can be defined at the configuration level or using command line flags.</p> <p>It can also be overriden on a per test or per test step basis but not at the operation level.</p>"},{"location":"tests/#parallel-execution-of-tests","title":"Parallel Execution of Tests","text":"<p>While Chainsaw ensures that the steps within a test are executed sequentially, it is designed to run multiple tests in parallel to each other. This parallel execution helps in significantly reducing the overall time required to run an entire suite of tests, making the testing process more efficient, especially in scenarios with a large number of tests.</p> <p>Parallel execution of tests</p> <p>By default, Chainsaw will run tests in parallel.</p> <p>This can be configured at the configuration level or using command line flags. However, individual tests can be configured to run concurrently by setting <code>Concurrent: true</code> in their <code>TestSpec</code>.</p> <p>All non-concurrent tests are executed first, followed by the concurrent tests in parallel.</p>"},{"location":"tests/manifests-based/","title":"Manifests based syntax","text":"<p>This is the simplest and less verbose supported syntax.</p> <p>You provide bare Kubernetes resource manifests and Chainsaw will use those manifests to create, update, or assert expectations against a cluster.</p> <p>While this syntax is simple, it doesn't support deletion operations and doesn't allow specifying additional configuration per test or step.</p> <p>It also relies a lot on file naming conventions and makes it hard to reuse files across multiple tests.</p>"},{"location":"tests/manifests-based/#file-naming-convention","title":"File naming convention","text":"<p>Manifest files must follow the naming convention <code>&lt;step index&gt;-&lt;name|assert|errors&gt;.yaml</code>.</p> <p>As an example <code>00-configmap.yaml</code>, <code>01-assert.yaml</code> and <code>02-errors.yaml</code> can all be considered valid file names.</p> <p>It's also perfectly valid to have multiple files for the same step. Let's imagine we have the following files <code>00-resources.yaml</code>, <code>00-more-resources.yaml</code>, <code>00-assert.yaml</code> and <code>00-errors.yaml</code>:</p> <ul> <li><code>00-resources.yaml</code> and <code>00-more-resources.yaml</code> contain resources that will be applied in step <code>00</code></li> <li><code>00-assert.yaml</code> contains assert statements in step <code>00</code></li> <li><code>00-errors.yaml</code> contains error statements in step <code>00</code></li> </ul> <p>With the four files above, Chainsaw will assemble a test step made of the combination of all those files.</p>"},{"location":"tests/manifests-based/#manifests-loading-process","title":"Manifests loading process","text":"<p>The logic to determine the content of a step is always:</p> <ul> <li>The step index is obtained from the beginning of the file name, it must be composed of two numbers between <code>0</code> and <code>9</code> (from <code>00</code> to <code>99</code>)</li> <li>The next character acts as a separator and is expected to be <code>-</code></li> <li>The rest of the file name (without extension) is then evaluated<ul> <li>If it is equal to <code>assert</code>, the content is considered assertion statements</li> <li>If it is equal to <code>error</code>, the content is considered error statements</li> <li>Else the content is considered resources to be applied</li> </ul> </li> <li>The extension must be <code>.yaml</code> or <code>.yml</code></li> </ul>"},{"location":"tests/manifests-based/#example","title":"Example","text":""},{"location":"tests/manifests-based/#01-configmapyaml","title":"01-configmap.yaml","text":"<p>The manifest below contains a config map in a file called <code>01-configmap.yaml</code>. Chainsaw will associate this manifest with an apply operation in step <code>01</code>.</p> <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: chainsaw-quick-start\ndata:\n  foo: bar\n</code></pre>"},{"location":"tests/manifests-based/#02-assertyaml","title":"02-assert.yaml","text":"<p>The manifest below contains an assertion statement in a file called <code>02-assert.yaml</code>. Chainsaw will associate this manifest with an assert operation in step <code>02</code>.</p> <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: chainsaw-quick-start\ndata:\n  foo: bar\n</code></pre>"},{"location":"tests/manifests-based/#03-errorsyaml","title":"03-errors.yaml","text":"<p>The manifest below contains an error statement in a file called <code>03-errors.yaml</code>. Chainsaw will associate this manifest with an error operation in step <code>03</code>.</p> <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: chainsaw-quick-start\ndata:\n  lorem: ipsum\n</code></pre>"},{"location":"tests/manifests-based/#conclusion","title":"Conclusion","text":"<p>This test will first create a config map, then assert the content of the config map contains the <code>foo: bar</code> data, and then verify that the configmap does not contain the <code>lorem: ipsum</code> data.</p> <p>Assert and error statements are very similar to standard resource definitions, they share the same structure but can be partial. Chainsaw will process only the elements present in the statements against the actual resource definition.</p>"},{"location":"tests/test-based/","title":"<code>Test</code> based syntax","text":"<p>The <code>Test</code> based syntax is more verbose than the manifests based syntax but offers more flexibility and features:</p> <ul> <li>Does not rely on file naming conventions for operations ordering</li> <li>Allows to easily reuse files accross multiple tests</li> <li>Offers the flexibility to provide additional configuration at the test, step and operation level</li> <li>Supports all operations and collectors</li> </ul>"},{"location":"tests/test-based/#the-test-resource","title":"The <code>Test</code> resource","text":"<p>A <code>Test</code> resource, like any Kubernetes resource has an <code>apiVersion</code>, <code>kind</code> and <code>metadata</code> section.</p> <p>It also comes with a <code>spec</code> section used to declaratively represent the steps of a test and other configuration elements belonging to the test being defined.</p> <p>Reference documentation</p> <p>The full structure of the <code>Test</code> resource is documented here.</p>"},{"location":"tests/test-based/#test-steps","title":"Test steps","text":"<p>A <code>Test</code> is mostly made of test steps. Test steps are detailed in a dedicated documentation.</p>"},{"location":"tests/test-based/#example","title":"Example","text":""},{"location":"tests/test-based/#chainsaw-testyaml","title":"chainsaw-test.yaml","text":"<p>The manifest below contains a <code>Test</code> in a file called <code>chainsaw-test.yaml</code>.</p> <p>Chainsaw will load the <code>Test</code> and steps defined in its <code>spec</code> section.</p> <p>The <code>Test</code> uses a custom <code>timeouts</code> for the whole test. Note that <code>timeouts</code> could have been overridden in specific steps if needed.</p> <pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: test-name\nspec:\n  skip: false\n  concurrent: false\n  skipDelete: false\n  # these timeouts are applied per operation\n  timeouts:\n    apply: 10s\n    assert: 10s\n    error: 10s\n  steps:\n  # first step\n  # apply a configmap to the cluster\n  # the path to the configmap is relative to the folder\n  # containing the test, hence allow reusing manifests\n  # across multiple tests\n  - try:\n    - apply:\n        file: ../resources/configmap.yaml\n  # second step\n  # execute assert statements against existing resources\n  # in the cluster\n  - try:\n    - assert:\n        file: ../resources/configmap-assert.yaml\n  # third step\n  # execute error statements against existing resources\n  # in the cluster\n  - try:\n    - error:\n        file: ../resources/configmap-error.yaml\n</code></pre>"},{"location":"tests/test-based/#specifying-a-custom-test-file","title":"Specifying a Custom Test File","text":"<p>If you have your test defined in a different file, you can specify it when running Chainsaw:</p> <pre><code>chainsaw test . --test-file=&lt;custom-test-file-name&gt;.yaml\n</code></pre>"},{"location":"tests/test-based/#raw-resource-support","title":"Raw Resource Support","text":"<p>Chainsaw now includes the raw resource feature, allowing direct specification of Kubernetes resources within the test definitions.</p> <p>This feature offers a more streamlined approach for defining resources, especially useful for simpler test scenarios or for cases where resource definitions need to be reused or slightly modified across different tests.</p>"},{"location":"tests/test-based/#example-raw-resource","title":"Example Raw Resource","text":"<pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: test-name\nspec:\n  skip: false\n  concurrent: false\n  skipDelete: false\n  timeouts:\n    apply: 10s\n    assert: 10s\n    error: 10s\n  steps:\n  # first step applies a configmap directly to the cluster\n  - try:\n    - apply:\n        resource:\n          apiVersion: v1\n          kind: ConfigMap\n          metadata:\n            name: chainsaw-quick-start\n          data:\n            foo: bar\n  # second step executes assert statements against existing resources\n  - try:\n    - assert:\n        file: ../resources/configmap-assert.yaml\n  # third step executes error statements against existing resources\n  - try:\n    - error:\n        file: ../resources/configmap-error.yaml\n</code></pre>"},{"location":"tests/test-based/#url-support-for-file-references","title":"URL Support for File References","text":"<p>Chainsaw has support for URLs in file references for assert, apply, error and similar operations.</p> <p>This feature enhances the reach of Chainsaw by allowing users to reference files hosted on remote locations, such as GitHub raw URLs or other web URLs, directly within their test definitions.</p>"},{"location":"tests/test-based/#example-url-file-reference","title":"Example URL File Reference","text":"<pre><code>apiVersion: chainsaw.kyverno.io/v1alpha1\nkind: Test\nmetadata:\n  name: test-name\nspec:\n  skip: false\n  concurrent: false\n  skipDelete: false\n  timeouts:\n    apply: 10s\n    assert: 10s\n    error: 10s\n  steps:\n  # first step\n  # apply a Kubernetes manifest hosted at a GitHub raw URL\n  - try:\n    - apply:\n        file: https://raw.githubusercontent.com/username/repo/branch/path/to/configmap.yaml\n  # second step\n  # execute assert statements against existing resources\n  # using a file hosted on another web URL\n  - try:\n    - assert:\n        file: https://example.com/path/to/configmap-assert.yaml\n  # third step\n  # execute error statements against existing resources\n  - try:\n    - error:\n        file: https://mywebsite.com/path/to/configmap-error.yaml\n</code></pre>"},{"location":"blog/archive/2023/","title":"2023","text":""},{"location":"blog/category/writing-tests/","title":"Writing Tests","text":""},{"location":"blog/category/announcements/","title":"announcements","text":""}]}